**# **Lesson 16: Variation of Constants for First-Order ODEs**

## **Part 1: Audio Lesson Script**

"Alright, let's talk about one of the most powerful techniques in ODEs - variation of constants. This is going to be huge for you, not just for first-order equations, but it's the foundation for solving ANY linear ODE with ANY forcing function. Prof. Ditkowski loves this method because it always works, unlike undetermined coefficients which only handles specific types of forcing.

So basically, here's the genius idea. We start with a linear first-order ODE: y' + p(t)y = g(t). Now, we already know how to solve the homogeneous version where g(t) = 0, right? We get y_h = Ce^(-∫p(t)dt). The brilliant insight is: what if we let that constant C vary with time? What if C becomes C(t)?

Let me show you why this is so clever. If we assume our solution has the form y = C(t)·y_h(t), where y_h is the homogeneous solution, then we're essentially saying 'the solution looks like the homogeneous solution, but with a time-varying amplitude.' This is physically intuitive - think of a damped oscillator being driven by an external force. The natural response gets modulated by the forcing.

Here's the key derivation - and yes, this WILL be on your exam. We start with y = C(t)·y_h(t). Taking the derivative:
y' = C'(t)·y_h(t) + C(t)·y_h'(t)

Now substitute into our original equation:
C'(t)·y_h(t) + C(t)·y_h'(t) + p(t)·C(t)·y_h(t) = g(t)

But wait! Remember that y_h satisfies y_h' + p(t)·y_h = 0. So the terms C(t)·y_h'(t) + p(t)·C(t)·y_h(t) equal zero! This leaves us with:
C'(t)·y_h(t) = g(t)

Therefore: C'(t) = g(t)/y_h(t)

And integrating: C(t) = ∫(g(t)/y_h(t))dt + K

So our particular solution is: y_p = y_h(t)·∫(g(t)/y_h(t))dt

Let me work through a concrete example. Consider y' - 2y = e^(3t). First, find the homogeneous solution: y_h = Ce^(2t). Now for variation of constants, we set y = C(t)e^(2t). Then:
C'(t)e^(2t) = e^(3t)
C'(t) = e^t
C(t) = e^t + K

So our general solution is y = (e^t + K)e^(2t) = e^(3t) + Ke^(2t). The particular solution is y_p = e^(3t).

Here's a more complex example that shows the real power: y' + (1/t)y = sin(t)/t. The homogeneous solution is y_h = C/t. Using variation:
C'(t)/t = sin(t)/t
C'(t) = sin(t)
C(t) = -cos(t) + K

General solution: y = (-cos(t) + K)/t. Notice how smoothly this handles a forcing function that would be impossible with undetermined coefficients!

The connection to integrating factors is beautiful. Remember, our integrating factor is μ(t) = e^(∫p(t)dt). Well, y_h = Ce^(-∫p(t)dt) = C/μ(t). So the variation formula becomes:
y_p = (1/μ(t))·∫μ(t)g(t)dt

This is exactly what we get from the integrating factor method! They're the same thing viewed differently.

Now, here's what makes variation of constants so powerful - it works for ANY continuous forcing function g(t). Undetermined coefficients only works for polynomials, exponentials, sines, and cosines. But variation? It handles everything: step functions, impulses, weird combinations, anything Prof. Ditkowski throws at you.

Common mistakes to avoid: First, don't forget to find y_h correctly - if that's wrong, everything fails. Second, when integrating g(t)/y_h(t), simplify BEFORE integrating. Third, remember that the constant of integration gives you the homogeneous solution back, so your general solution is y = y_p + y_h.

For the exam, Prof. Ditkowski often gives you a problem where undetermined coefficients would be messy or impossible, forcing you to use variation of constants. Recognition is key - if the forcing function is t·ln(t), or e^(t²), or something exotic, immediately think variation of constants.

The physical interpretation is crucial for understanding. Think of it as the system's natural response being modulated by the forcing. The integral ∫(g(t)/y_h(t))dt represents the accumulated effect of the forcing, weighted by how much it opposes the natural decay or growth of the system.

This method extends beautifully to second-order and higher-order equations, which you'll see later. The idea remains the same - assume the solution is a linear combination of homogeneous solutions with time-varying coefficients. For systems, it becomes the fundamental matrix method.

Remember: variation of constants is your universal solver. When in doubt on the exam, this method will always work. Just be careful with your integration, and always verify your solution by substitution."

## **Part 2: LaTeX Theory Document**

```latex
\documentclass[12pt]{article}
\usepackage{amsmath, amssymb, amsthm, tikz, pgfplots}
\usepackage{geometry, enumitem, mdframed, array, xcolor}
\geometry{margin=1in}

% Custom environments
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{method}{Method}
\newtheorem{example}{Example}
\newmdenv[linecolor=blue,linewidth=2pt]{keypoint}
\newmdenv[linecolor=red,linewidth=2pt]{warning}
\newmdenv[linecolor=green,linewidth=2pt]{insight}
\newmdenv[linecolor=purple,linewidth=2pt]{examtip}
\newmdenv[linecolor=orange,linewidth=2pt]{formula}

\title{Lesson 16: Variation of Constants for First-Order ODEs}
\author{ODE 1 - Prof. Adi Ditkowski}
\date{Tel Aviv University}

\begin{document}
\maketitle

\section{Introduction and Motivation}

\begin{definition}[Variation of Constants Method]
For the linear first-order ODE
\[y' + p(t)y = g(t)\]
the method of variation of constants seeks a particular solution by allowing the constant in the homogeneous solution to vary with time.
\end{definition}

\begin{keypoint}
The variation of constants method works for ANY continuous forcing function $g(t)$, unlike undetermined coefficients which requires specific forms.
\end{keypoint}

\section{Theoretical Development}

\subsection{The Fundamental Idea}

\begin{theorem}[Variation of Constants Formula]
Given the linear ODE $y' + p(t)y = g(t)$ with homogeneous solution $y_h = Ce^{-\int p(t)dt}$, a particular solution is:
\[y_p = y_h(t) \int \frac{g(t)}{y_h(t)} dt\]
\end{theorem}

\begin{proof}
Assume $y = C(t) \cdot y_h(t)$ where $y_h$ solves $y_h' + p(t)y_h = 0$.

Differentiating:
\[y' = C'(t)y_h(t) + C(t)y_h'(t)\]

Substituting into the original equation:
\[C'(t)y_h(t) + C(t)y_h'(t) + p(t)C(t)y_h(t) = g(t)\]

Since $y_h' + p(t)y_h = 0$, we have $y_h' = -p(t)y_h$:
\[C'(t)y_h(t) + C(t)(-p(t)y_h(t)) + p(t)C(t)y_h(t) = g(t)\]
\[C'(t)y_h(t) = g(t)\]

Therefore:
\[C'(t) = \frac{g(t)}{y_h(t)}\]
\[C(t) = \int \frac{g(t)}{y_h(t)} dt + K\]

The general solution is:
\[y = y_h(t) \left(\int \frac{g(t)}{y_h(t)} dt + K\right) = y_p + Ky_h\]
\end{proof}

\subsection{Connection to Integrating Factor}

\begin{insight}
The variation of constants formula is equivalent to the integrating factor method:
\[\mu(t) = e^{\int p(t)dt}, \quad y_h = \frac{C}{\mu(t)}\]
\[y_p = \frac{1}{\mu(t)} \int \mu(t)g(t)dt\]
\end{insight}

\section{Solution Algorithm}

\begin{method}[Step-by-Step Procedure]
\begin{enumerate}
    \item \textbf{Identify} the equation in standard form: $y' + p(t)y = g(t)$
    \item \textbf{Solve} the homogeneous equation: $y_h = Ce^{-\int p(t)dt}$
    \item \textbf{Set up} the variation: $y = C(t) \cdot y_h(t)$
    \item \textbf{Differentiate} and substitute to find: $C'(t) = \frac{g(t)}{y_h(t)}$
    \item \textbf{Integrate} to find $C(t)$: $C(t) = \int \frac{g(t)}{y_h(t)}dt + K$
    \item \textbf{Construct} the general solution: $y = C(t) \cdot y_h(t)$
    \item \textbf{Apply} initial conditions if given
\end{enumerate}
\end{method}

\section{Worked Examples}

\begin{example}[Exponential Forcing]
Solve $y' - 3y = e^{5t}$ with $y(0) = 2$.

\textbf{Solution:}
\begin{enumerate}
    \item Homogeneous solution: $y_h = Ce^{3t}$
    \item Variation setup: $y = C(t)e^{3t}$
    \item Finding $C'(t)$:
    \[C'(t)e^{3t} = e^{5t} \Rightarrow C'(t) = e^{2t}\]
    \item Integrating:
    \[C(t) = \frac{1}{2}e^{2t} + K\]
    \item General solution:
    \[y = \left(\frac{1}{2}e^{2t} + K\right)e^{3t} = \frac{1}{2}e^{5t} + Ke^{3t}\]
    \item Apply initial condition:
    \[2 = \frac{1}{2} + K \Rightarrow K = \frac{3}{2}\]
    \item Final solution:
    \[y = \frac{1}{2}e^{5t} + \frac{3}{2}e^{3t}\]
\end{enumerate}
\end{example}

\begin{example}[Non-Standard Forcing]
Solve $y' + \frac{2}{t}y = t\ln(t)$ for $t > 0$.

\textbf{Solution:}
\begin{enumerate}
    \item Homogeneous solution: $y_h = \frac{C}{t^2}$
    \item Variation: $y = \frac{C(t)}{t^2}$
    \item Finding $C'(t)$:
    \[\frac{C'(t)}{t^2} = t\ln(t) \Rightarrow C'(t) = t^3\ln(t)\]
    \item Integration by parts:
    \[C(t) = \int t^3\ln(t)dt = \frac{t^4\ln(t)}{4} - \frac{t^4}{16} + K\]
    \item General solution:
    \[y = \frac{t^2\ln(t)}{4} - \frac{t^2}{16} + \frac{K}{t^2}\]
\end{enumerate}
\end{example}

\section{Advantages and Applications}

\begin{keypoint}
\textbf{Advantages over Undetermined Coefficients:}
\begin{itemize}
    \item Works for any continuous $g(t)$
    \item No need to guess solution form
    \item Systematic procedure always succeeds
    \item Extends naturally to higher-order equations
    \item Provides Green's function interpretation
\end{itemize}
\end{keypoint}

\begin{warning}
\textbf{Common Errors:}
\begin{itemize}
    \item Incorrect homogeneous solution
    \item Forgetting to simplify before integration
    \item Missing the constant of integration
    \item Not including full general solution
    \item Sign errors in exponential arguments
\end{itemize}
\end{warning}

\section{Physical Interpretation}

\begin{insight}
The variation of constants represents:
\begin{itemize}
    \item \textbf{RC Circuit:} Time-varying charge accumulation
    \item \textbf{Population Model:} Variable immigration/emigration
    \item \textbf{Heat Transfer:} Time-dependent source term
    \item \textbf{Mechanical System:} External forcing modulation
\end{itemize}

The integral $\int \frac{g(t)}{y_h(t)}dt$ accumulates the forcing effect, weighted inversely by the system's natural response.
\end{insight}

\section{Connection to Green's Functions}

\begin{definition}[Green's Function Preview]
The solution can be written as:
\[y(t) = y_h(t)y(t_0)/y_h(t_0) + \int_{t_0}^t G(t,s)g(s)ds\]
where $G(t,s) = y_h(t)/y_h(s)$ for $s \leq t$ is the Green's function.
\end{definition}

\section{Exam Strategy}

\begin{examtip}
\textbf{Prof. Ditkowski's Exam Focus:}
\begin{enumerate}
    \item Always show the homogeneous solution first
    \item Explicitly write $C'(t) = g(t)/y_h(t)$
    \item Simplify integrands before integrating
    \item State the general solution as $y = y_p + y_h$
    \item Verify solution by substitution if time permits
    \item Use variation for non-standard forcing functions
\end{enumerate}
\end{examtip}

\begin{formula}
\textbf{Key Formulas to Memorize:}
\begin{align}
y_h &= Ce^{-\int p(t)dt} \\
C'(t) &= \frac{g(t)}{y_h(t)} \\
y_p &= y_h(t) \int \frac{g(t)}{y_h(t)}dt \\
y &= y_p + Cy_h
\end{align}
\end{formula}

\end{document}
```

## **Part 3: LaTeX Practice Problems**

```latex
\documentclass[12pt]{article}
\usepackage{amsmath, amssymb, amsthm, enumitem, mdframed}
\usepackage{geometry, xcolor}
\geometry{margin=1in}

\newmdenv[linecolor=blue,linewidth=2pt]{hint}
\newtheorem{problem}{Problem}

\title{Lesson 16: Practice Problems - Variation of Constants}
\author{ODE 1 - Prof. Adi Ditkowski}
\date{Tel Aviv University}

\begin{document}
\maketitle

\section*{Part A: Basic Variation of Constants (5 Problems)}

\begin{problem}
Solve $y' - 2y = e^{4t}$ using variation of constants.
\end{problem}

\begin{problem}
Solve $y' + y = \sin(2t)$ using variation of constants.
\end{problem}

\begin{problem}
Solve $y' + 3y = t^2$ using variation of constants.
\end{problem}

\begin{problem}
Solve $y' - \frac{1}{t}y = t^3$ for $t > 0$ using variation of constants.
\end{problem}

\begin{problem}
Solve $y' + 4y = e^{-4t}$ using variation of constants. Note the resonance!
\end{problem}

\section*{Part B: Non-Standard Forcing Functions (6 Problems)}

\begin{problem}
Solve $y' - y = e^t \ln(t)$ for $t > 0$.
\end{problem}

\begin{problem}
Solve $y' + 2y = \frac{\sin(t)}{t}$ for $t > 0$.
\end{problem}

\begin{problem}
Solve $y' + \frac{1}{t}y = \cos(\ln(t))$ for $t > 0$.
\end{problem}

\begin{problem}
Solve $y' - 3y = e^{3t}t^2$ (resonance with polynomial).
\end{problem}

\begin{problem}
Solve $y' + y = \frac{1}{1+e^t}$.
\end{problem}

\begin{problem}
Solve $y' + ty = te^{-t^2/2}$.
\end{problem}

\section*{Part C: Initial Value Problems (5 Problems)}

\begin{problem}
Solve $y' - 2y = e^t$, $y(0) = 3$.
\end{problem}

\begin{problem}
Solve $y' + \frac{2}{t}y = t^2$, $y(1) = 2$ for $t > 0$.
\end{problem}

\begin{problem}
Solve $y' + 3y = e^{-3t}\cos(t)$, $y(0) = 0$.
\end{problem}

\begin{problem}
Solve $y' - y = \frac{1}{1+e^{-t}}$, $y(0) = 1$.
\end{problem}

\begin{problem}
Solve $y' + (\tan t)y = \sec t$, $y(0) = 1$ for $-\pi/2 < t < \pi/2$.
\end{problem}

\section*{Part D: Comparison with Other Methods (5 Problems)}

\begin{problem}
Solve $y' + 2y = 3e^{-2t}$ using:
a) Integrating factor method
b) Variation of constants
c) Show the solutions are identical
\end{problem}

\begin{problem}
For $y' - y = e^t$:
a) Explain why undetermined coefficients fails
b) Solve using variation of constants
c) Interpret the resonance physically
\end{problem}

\begin{problem}
Solve $y' + p(t)y = g(t)$ where:
\[p(t) = \begin{cases} 1 & 0 \leq t < 1 \\ 2 & t \geq 1 \end{cases}, \quad g(t) = 1\]
Use variation of constants on each interval.
\end{problem}

\begin{problem}
Show that for $y' + p(t)y = g(t)$, the variation of constants formula and integrating factor formula give the same result.
\end{problem}

\begin{problem}
Solve $ty' - y = t^2e^t$ for $t > 0$:
a) First convert to standard form
b) Apply variation of constants
c) Verify the solution
\end{problem}

\section*{Part E: Theoretical Problems (4 Problems)}

\begin{problem}
Prove that if $y_1$ and $y_2$ are solutions to $y' + p(t)y = g_1(t)$ and $y' + p(t)y = g_2(t)$ respectively, then $y_1 + y_2$ solves $y' + p(t)y = g_1(t) + g_2(t)$.
\end{problem}

\begin{problem}
Show that the variation of constants formula:
\[y_p = y_h(t) \int \frac{g(t)}{y_h(t)}dt\]
can be written as:
\[y_p(t) = \int_{t_0}^t \frac{y_h(t)}{y_h(s)} g(s) ds\]
Interpret this as a Green's function representation.
\end{problem}

\begin{problem}
Prove that for the equation $y' + p(t)y = g(t)$, if $p(t)$ and $g(t)$ are continuous on $[a,b]$, then the solution exists and is unique on the entire interval.
\end{problem}

\begin{problem}
Derive the variation of constants formula starting from the integrating factor approach. Show all steps.
\end{problem}

\section*{Part F: Exam-Style Problems (5 Problems)}

\begin{problem}[15 points]
Consider the equation $y' + \frac{2t}{1+t^2}y = \frac{1}{1+t^2}$.
\begin{enumerate}[a)]
    \item Find the homogeneous solution
    \item Use variation of constants to find the general solution
    \item Find the solution satisfying $y(0) = 1$
    \item Determine the behavior as $t \to \infty$
\end{enumerate}
\end{problem}

\begin{problem}[20 points]
The current $i(t)$ in an RL circuit satisfies:
\[L\frac{di}{dt} + Ri = V(t)\]
where $L = 1$ H, $R = 2$ Ω, and $V(t) = 10e^{-2t}\sin(3t)$ V.
\begin{enumerate}[a)]
    \item Convert to standard form
    \item Find the steady-state current using variation of constants
    \item If $i(0) = 0$, find the complete solution
    \item Identify transient and steady-state components
\end{enumerate}
\end{problem}

\begin{problem}[15 points]
For the equation $y' - \frac{n}{t}y = t^m$ where $n, m$ are constants and $t > 0$:
\begin{enumerate}[a)]
    \item Find the general solution using variation of constants
    \item For what values of $n$ and $m$ does the solution remain bounded as $t \to \infty$?
    \item Find the particular solution that remains finite at $t = 0$ when possible
\end{enumerate}
\end{problem}

\begin{problem}[20 points]
Consider $y' + y = f(t)$ where:
\[f(t) = \begin{cases}
1 & 0 \leq t < \pi \\
\sin(t) & t \geq \pi
\end{cases}\]
\begin{enumerate}[a)]
    \item Solve on $[0, \pi)$ with $y(0) = 0$
    \item Use continuity at $t = \pi$ to find initial condition for $t \geq \pi$
    \item Solve on $[\pi, \infty)$
    \item Sketch the solution
\end{enumerate}
\end{problem}

\begin{problem}[15 points - Theoretical]
\begin{enumerate}[a)]
    \item State the variation of constants formula for $y' + p(t)y = g(t)$
    \item Prove that this formula gives a particular solution
    \item Show that if $g(t) = g_1(t) + g_2(t)$, then $y_p = y_{p1} + y_{p2}$
    \item Explain why variation of constants works for any continuous $g(t)$
\end{enumerate}
\end{problem}

\begin{hint}
\textbf{Solution Hints:}
\begin{itemize}
    \item Problem 5: Resonance occurs when forcing matches natural frequency
    \item Problem 10: Use substitution $u = 1 + e^t$
    \item Problem 11: The coefficient $t$ suggests $y_h = Ce^{-t^2/2}$
    \item Problem 20: Convert using $p(t) = 2t/(1+t^2)$, notice $\int p(t)dt = \ln(1+t^2)$
    \item Problem 24: Use piecewise approach with continuity condition
\end{itemize}
\end{hint}

\end{document}
```

## **Part 4: NotebookLM Instructions**

### **How to Use These Materials with NotebookLM**

**Upload Instructions:**
1. Save the audio script as "Lesson16_Audio_VariationConstants.txt"
2. Save the theory LaTeX as "Lesson16_Theory_VariationConstants.tex"
3. Save the practice problems as "Lesson16_Problems_VariationConstants.tex"
4. Upload all three files to NotebookLM

**Audio Generation Prompts for NotebookLM:**
- "Create a conversational podcast explaining variation of constants, emphasizing why it works for any forcing function"
- "Generate a discussion about when to use variation of constants versus undetermined coefficients"
- "Explain the connection between variation of constants and integrating factors"
- "Create a problem-solving walkthrough for variation of constants with non-standard forcing"

**Study Guide Creation:**
1. Ask NotebookLM: "Create a step-by-step algorithm for solving any first-order linear ODE using variation of constants"
2. Request: "Generate a comparison table between variation of constants, integrating factor, and undetermined coefficients"
3. Query: "List all the types of forcing functions where variation of constants is the only method that works"

**Integration with Previous Lessons:**
- Link to Lesson 14 (Standard Method) for homogeneous solution techniques
- Connect to Lesson 15 (Integrating Factor) to see equivalence
- Reference Block 4 for recognizing when standard methods fail

**Practice Strategy:**
1. **Day 1:** Master the basic algorithm (Part A problems)
2. **Day 2:** Non-standard forcing functions (Part B problems)
3. **Day 3:** Initial value problems and theoretical understanding (Parts C & E)
4. **Day 4:** Comparison with other methods (Part D)
5. **Day 5:** Exam-style mixed problems (Part F)

**Key Formulas Flash Cards:**
Create cards for:
- Variation formula: $C'(t) = g(t)/y_h(t)$
- Particular solution: $y_p = y_h \int (g/y_h)dt$
- Connection to μ: $y_p = (1/μ) \int μg dt$
- General solution structure: $y = y_p + Cy_h$

**Common Exam Patterns:**
1. Forcing functions like $e^{at}\ln(t)$, $t^n e^{bt}$, $\sin(t)/t$
2. Resonance cases where forcing matches natural response
3. Piecewise continuous forcing requiring interval analysis
4. Comparison problems testing method selection
5. Physical applications (circuits, mixing, population)

**Time Management Tips:**
- Spend 30% of time on finding correct $y_h$
- 50% on integration for $C(t)$
- 20% on applying initial conditions and verification
- Always state general solution before applying IC

**Warning Signs You Need Variation of Constants:**
- Forcing function contains ln, inverse trig, or non-polynomial/exponential terms
- Undetermined coefficients would require infinite terms
- Problem explicitly says "use variation of constants"
- Physical context involves arbitrary time-dependent forcing

---

**Lesson 16 complete. This concludes Block 5: Linear First-Order ODEs.**

**Study Checklist:**
- [ ] Understand why constant becomes function
- [ ] Master the derivation of $C'(t) = g(t)/y_h(t)$
- [ ] Practice integration with complex forcing functions
- [ ] Connect to integrating factor method
- [ ] Recognize when variation is necessary vs optional
- [ ] Prepare for extension to second-order (Block 12)

This lesson provides the universal tool for solving any linear first-order ODE, setting you up for success on Prof. Ditkowski's exam where 40% of problems involve linear equations!


