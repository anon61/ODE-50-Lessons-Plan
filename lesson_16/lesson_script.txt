Episode 16: Variation of Constants for First-Order ODEs

Alright, let's talk about one of the most powerful techniques in ODEs - variation of constants. This is going to be huge for you, not just for first-order equations, but it's the foundation for solving ANY linear ODE with ANY forcing function. Prof. Ditkowski loves this method because it always works, unlike undetermined coefficients which only handles specific types of forcing.

So basically, here's the genius idea. We start with a linear first-order ODE: y' + p(t)y = g(t). Now, we already know how to solve the homogeneous version where g(t) = 0, right? We get y_h = Ce^(-∫p(t)dt). The brilliant insight is: what if we let that constant C vary with time? What if C becomes C(t)?

Let me show you why this is so clever. If we assume our solution has the form y = C(t)·y_h(t), where y_h is the homogeneous solution, then we're essentially saying 'the solution looks like the homogeneous solution, but with a time-varying amplitude.' This is physically intuitive - think of a damped oscillator being driven by an external force. The natural response gets modulated by the forcing.

Here's the key derivation - and yes, this WILL be on your exam. We start with y = C(t)·y_h(t). Taking the derivative:
y' = C'(t)·y_h(t) + C(t)·y_h'(t)

Now substitute into our original equation:
C'(t)·y_h(t) + C(t)·y_h'(t) + p(t)·C(t)·y_h(t) = g(t)

But wait! Remember that y_h satisfies y_h' + p(t)·y_h = 0. So the terms C(t)·y_h'(t) + p(t)·C(t)·y_h(t) equal zero! This leaves us with:
C'(t)·y_h(t) = g(t)

Therefore: C'(t) = g(t)/y_h(t)

And integrating: C(t) = ∫(g(t)/y_h(t))dt + K

So our particular solution is: y_p = y_h(t)·∫(g(t)/y_h(t))dt

Let me work through a concrete example. Consider y' - 2y = e^(3t). First, find the homogeneous solution: y_h = Ce^(2t). Now for variation of constants, we set y = C(t)e^(2t). Then:
C'(t)e^(2t) = e^(3t)
C'(t) = e^t
C(t) = e^t + K

So our general solution is y = (e^t + K)e^(2t) = e^(3t) + Ke^(2t). The particular solution is y_p = e^(3t).

Here's a more complex example that shows the real power: y' + (1/t)y = sin(t)/t. The homogeneous solution is y_h = C/t. Using variation:
C'(t)/t = sin(t)/t
C'(t) = sin(t)
C(t) = -cos(t) + K

General solution: y = (-cos(t) + K)/t. Notice how smoothly this handles a forcing function that would be impossible with undetermined coefficients!

The connection to integrating factors is beautiful. Remember, our integrating factor is μ(t) = e^(∫p(t)dt). Well, y_h = Ce^(-∫p(t)dt) = C/μ(t). So the variation formula becomes:
y_p = (1/μ(t))·∫μ(t)g(t)dt

This is exactly what we get from the integrating factor method! They're the same thing viewed differently.

Now, here's what makes variation of constants so powerful - it works for ANY continuous forcing function g(t). Undetermined coefficients only works for polynomials, exponentials, sines, and cosines. But variation? It handles everything: step functions, impulses, weird combinations, anything Prof. Ditkowski throws at you.

Common mistakes to avoid: First, don't forget to find y_h correctly - if that's wrong, everything fails. Second, when integrating g(t)/y_h(t), simplify BEFORE integrating. Third, remember that the constant of integration gives you the homogeneous solution back, so your general solution is y = y_p + y_h.

For the exam, Prof. Ditkowski often gives you a problem where undetermined coefficients would be messy or impossible, forcing you to use variation of constants. Recognition is key - if the forcing function is t·ln(t), or e^(t²), or something exotic, immediately think variation of constants.

The physical interpretation is crucial for understanding. Think of it as the system's natural response being modulated by the forcing. The integral ∫(g(t)/y_h(t))dt represents the accumulated effect of the forcing, weighted by how much it opposes the natural decay or growth of the system.

This method extends beautifully to second-order and higher-order equations, which you'll see later. The idea remains the same - assume the solution is a linear combination of homogeneous solutions with time-varying coefficients. For systems, it becomes the fundamental matrix method.

Remember: variation of constants is your universal solver. When in doubt on the exam, this method will always work. Just be careful with your integration, and always verify your solution by substitution.