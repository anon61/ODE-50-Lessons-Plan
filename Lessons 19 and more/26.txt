# **Lesson 26: Converting Higher-Order to First-Order Systems**

## **Part 1: Audio Lesson Script**

"Alright, so let's dive into one of the most fundamental techniques in ODEs - converting higher-order equations into first-order systems. Here's the key insight: any nth-order differential equation can be rewritten as a system of n first-order equations. This isn't just a mathematical trick - it's THE foundation for how we actually solve complex ODEs numerically and analytically.

So basically, imagine you have this beast of an equation: y''' + 3y'' - 2y' + 5y = sin(t). Third-order, looks intimidating, right? Well, here's the magic - we can transform this into a nice, clean system of first-order equations that's actually easier to work with. Let me show you how.

The core idea is super intuitive once you see it. We introduce new variables for each derivative. So we set x₁ = y, x₂ = y', and x₃ = y''. See what we're doing? We're just giving names to each derivative level. Now, here's where it gets clever - we can write:
- x₁' = y' = x₂ (that's just the definition of derivative)
- x₂' = y'' = x₃ (same logic)
- x₃' = y''' = -3y'' + 2y' - 5y + sin(t) (from our original equation)

Substituting our new variables into that last line: x₃' = -3x₃ + 2x₂ - 5x₁ + sin(t).

Boom! We've converted our third-order equation into three first-order equations. But here's the really beautiful part - we can write this as a matrix equation. Define your state vector x = [x₁, x₂, x₃]ᵀ, and now:

x' = Ax + F(t)

where A is what we call the companion matrix. For our example:
A = [0, 1, 0; 0, 0, 1; -5, 2, -3] and F(t) = [0, 0, sin(t)]ᵀ

Notice the pattern in A? The first n-1 rows are super simple - just ones on the superdiagonal. The last row contains the negative coefficients from your original equation, but in reverse order! This structure is CRUCIAL for Prof. Ditkowski's exams - he loves testing whether you can quickly write down the companion matrix.

Let me give you another example, this time with initial conditions. Say we have:
y'' + 4y' + 3y = 0, with y(0) = 2 and y'(0) = -1

First, set up your state vector: x = [y, y']ᵀ = [x₁, x₂]ᵀ

The system becomes:
x₁' = x₂
x₂' = -3x₁ - 4x₂

In matrix form: x' = [0, 1; -3, -4]x

And here's the key part many students mess up - converting the initial conditions! Your initial state vector is x(0) = [y(0), y'(0)]ᵀ = [2, -1]ᵀ. Don't forget to maintain the same ordering!

Now, let's talk about a common exam trick. Prof. Ditkowski sometimes gives you a system and asks you to convert it BACK to a higher-order equation. Here's how: if you have the system x' = Ax, you can eliminate variables systematically.

For instance, if x₁' = x₂ and x₂' = -3x₁ - 4x₂, then:
- From the first equation: x₂ = x₁'
- Differentiate: x₂' = x₁''
- Substitute into the second equation: x₁'' = -3x₁ - 4x₁'
- Rearrange: x₁'' + 4x₁' + 3x₁ = 0

And since x₁ = y, we get back our original equation!

Here's a memory trick for the companion matrix: think of it as having a "staircase of ones" going up and to the right, with the "weights" (negative coefficients) on the bottom row. The sign pattern is ALWAYS negative for the bottom row when you're starting from the standard form y⁽ⁿ⁾ + aₙ₋₁y⁽ⁿ⁻¹⁾ + ... + a₀y = 0.

Common mistakes to avoid:
1. Wrong sign on the bottom row - remember, they're NEGATIVE
2. Coefficient order - they go from a₀ to aₙ₋₁ left to right
3. Forgetting to convert initial conditions properly
4. Missing the non-homogeneous term F(t) placement

One more advanced insight - this conversion preserves all the important properties of your equation. The eigenvalues of your companion matrix? They're exactly the roots of your characteristic polynomial! This connection becomes super important when we start solving these systems.

So basically, master this conversion process - it's not just a technique, it's THE bridge between scalar ODEs and systems. Every higher-order problem on Prof. Ditkowski's exam can be approached this way, and often should be! Practice until you can write down that companion matrix in your sleep."

## **Part 2: LaTeX Theory Document**

```latex
\documentclass[12pt]{article}
\usepackage{amsmath, amssymb, amsthm, tikz, pgfplots}
\usepackage{geometry, enumitem, mdframed, array, xcolor}
\usepackage{nicematrix}
\geometry{margin=1in}

\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{method}{Method}
\newtheorem{example}{Example}
\newmdenv[linecolor=blue,linewidth=2pt]{keypoint}
\newmdenv[linecolor=red,linewidth=2pt]{warning}
\newmdenv[linecolor=green,linewidth=2pt]{insight}
\newmdenv[linecolor=purple,linewidth=2pt]{examtip}
\newmdenv[linecolor=brown,linewidth=2pt]{computation}

\title{Lesson 26: Converting Higher-Order to First-Order Systems}
\author{ODE 1 - Prof. Adi Ditkowski}
\date{}

\begin{document}
\maketitle

\section{Fundamental Concept}

\begin{definition}[State Vector Representation]
For an $n$th-order differential equation, the \textbf{state vector} is defined as:
$$\mathbf{x} = \begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \end{bmatrix} = \begin{bmatrix} y \\ y' \\ \vdots \\ y^{(n-1)} \end{bmatrix}$$
where each component represents a successive derivative of the solution $y(t)$.
\end{definition}

\begin{keypoint}
Any $n$th-order linear ODE:
$$y^{(n)} + a_{n-1}(t)y^{(n-1)} + \cdots + a_1(t)y' + a_0(t)y = f(t)$$
can be converted to a first-order system:
$$\mathbf{x}' = A(t)\mathbf{x} + \mathbf{F}(t)$$
\end{keypoint}

\section{The Companion Matrix}

\begin{definition}[Companion Matrix]
For the equation $y^{(n)} + a_{n-1}y^{(n-1)} + \cdots + a_1y' + a_0y = 0$, the companion matrix is:
$$A = \begin{bmatrix}
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & \cdots & 1 \\
-a_0 & -a_1 & -a_2 & \cdots & -a_{n-1}
\end{bmatrix}$$
\end{definition}

\begin{insight}
The companion matrix has a special structure:
\begin{itemize}
\item First $n-1$ rows: ones on the superdiagonal, zeros elsewhere
\item Last row: negative coefficients in order from $a_0$ to $a_{n-1}$
\end{itemize}
\end{insight}

\section{Conversion Algorithm}

\begin{method}[Standard Conversion Procedure]
\begin{enumerate}
\item Write the equation in standard form: $y^{(n)} = -a_{n-1}y^{(n-1)} - \cdots - a_0y + f(t)$
\item Define state variables: $x_1 = y, x_2 = y', \ldots, x_n = y^{(n-1)}$
\item Write the system of equations:
\begin{align}
x_1' &= x_2 \\
x_2' &= x_3 \\
&\vdots \\
x_{n-1}' &= x_n \\
x_n' &= -a_{n-1}x_n - \cdots - a_1x_2 - a_0x_1 + f(t)
\end{align}
\item Express in matrix form: $\mathbf{x}' = A\mathbf{x} + \mathbf{F}(t)$
\end{enumerate}
\end{method}

\section{Examples}

\begin{example}[Second-Order Conversion]
Convert $y'' + 3y' + 2y = e^{-t}$ with $y(0) = 1$, $y'(0) = 0$.

\textbf{Solution:}
Set $x_1 = y$, $x_2 = y'$. Then:
$$\mathbf{x}' = \begin{bmatrix} 0 & 1 \\ -2 & -3 \end{bmatrix}\mathbf{x} + \begin{bmatrix} 0 \\ e^{-t} \end{bmatrix}$$
Initial condition: $\mathbf{x}(0) = \begin{bmatrix} 1 \\ 0 \end{bmatrix}$
\end{example}

\begin{example}[Third-Order Conversion]
Convert $y''' - 2y'' + y' - y = 0$.

\textbf{Solution:}
State vector: $\mathbf{x} = [y, y', y'']^T$

Companion matrix:
$$A = \begin{bmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ 1 & -1 & 2 \end{bmatrix}$$
\end{example}

\begin{warning}
Common errors:
\begin{itemize}
\item Incorrect signs in the last row (must be negative of coefficients)
\item Wrong ordering of coefficients (should be $a_0$ to $a_{n-1}$)
\item Forgetting to include non-homogeneous term in correct position
\end{itemize}
\end{warning}

\section{Reverse Conversion}

\begin{theorem}[System to Scalar Conversion]
Given a system $\mathbf{x}' = A\mathbf{x}$ where $A$ is a companion matrix, the first component $x_1(t)$ satisfies the scalar equation:
$$x_1^{(n)} + a_{n-1}x_1^{(n-1)} + \cdots + a_0x_1 = 0$$
\end{theorem}

\begin{computation}
To convert back:
\begin{enumerate}
\item Use $x_1' = x_2$, $x_2' = x_3$, etc.
\item Express all $x_i$ in terms of derivatives of $x_1$
\item Substitute into the last equation
\item Simplify to get scalar ODE
\end{enumerate}
\end{computation}

\section{Properties and Connections}

\begin{insight}
The eigenvalues of the companion matrix are exactly the roots of the characteristic polynomial:
$$\det(A - \lambda I) = (-1)^n(\lambda^n + a_{n-1}\lambda^{n-1} + \cdots + a_0)$$
\end{insight}

\begin{examtip}
Prof. Ditkowski often tests:
\begin{itemize}
\item Quick companion matrix construction (memorize the pattern!)
\item Converting initial conditions correctly
\item Recognizing when conversion simplifies a problem
\item Connection between eigenvalues and characteristic roots
\end{itemize}
\end{examtip}

\section{Special Cases}

\begin{example}[Variable Coefficients]
For $t^2y'' + ty' - y = 0$ (Euler equation):
\begin{enumerate}
\item First divide by $t^2$: $y'' + \frac{1}{t}y' - \frac{1}{t^2}y = 0$
\item Then convert: $A(t) = \begin{bmatrix} 0 & 1 \\ \frac{1}{t^2} & -\frac{1}{t} \end{bmatrix}$
\end{enumerate}
\end{example}

\end{document}
```

## **Part 3: Practice Problems**

```latex
\documentclass[12pt]{article}
\usepackage{amsmath, amssymb, enumitem, geometry}
\geometry{margin=1in}

\title{Lesson 26: Practice Problems}
\author{Converting Higher-Order to First-Order Systems}
\date{}

\begin{document}
\maketitle

\section*{Part A: Basic Conversions (6 problems)}

\begin{enumerate}
\item Convert to a first-order system: $y'' + 4y = 0$

\item Convert with initial conditions: $y'' - 3y' + 2y = 0$, $y(0) = 1$, $y'(0) = -1$

\item Write the companion matrix for: $y''' + 2y'' - y' + 3y = 0$

\item Convert the fourth-order equation: $y^{(4)} - y = 0$

\item Convert with forcing: $y'' + \omega^2 y = \cos(\omega t)$

\item Convert the Airy equation: $y'' - ty = 0$
\end{enumerate}

\section*{Part B: Companion Matrix Construction (5 problems)}

\begin{enumerate}[resume]
\item Find the companion matrix for: $y^{(5)} + y''' - 2y' = 0$

\item Given $A = \begin{bmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ -6 & -11 & -6 \end{bmatrix}$, find the corresponding scalar ODE.

\item Construct the companion matrix for: $2y''' + 3y'' - y' + 4y = 0$ (note the leading coefficient)

\item Find the companion matrix eigenvalues for: $y'' + 2y' + 2y = 0$

\item Write the companion matrix for the Bessel equation: $t^2y'' + ty' + (t^2 - n^2)y = 0$
\end{enumerate}

\section*{Part C: Reverse Conversion (5 problems)}

\begin{enumerate}[resume]
\item Convert the system $\begin{cases} x' = y \\ y' = -4x - 4y \end{cases}$ to a single second-order equation.

\item Given $\mathbf{x}' = \begin{bmatrix} 0 & 1 \\ -\omega^2 & -2\zeta\omega \end{bmatrix}\mathbf{x}$, find the scalar equation.

\item Convert $\begin{cases} x' = y \\ y' = z \\ z' = 6x - 11y + 6z \end{cases}$ to a third-order equation.

\item The system $\mathbf{x}' = \begin{bmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ 1 & 0 & 0 \end{bmatrix}\mathbf{x}$ corresponds to which scalar ODE?

\item Convert the coupled system $\begin{cases} u' = v \\ v' = -u + 2v \end{cases}$ to find equations for both $u$ and $v$.
\end{enumerate}

\section*{Part D: Initial Condition Conversion (5 problems)}

\begin{enumerate}[resume]
\item Convert IVP: $y''' + y' = 0$, $y(0) = 1$, $y'(0) = 0$, $y''(0) = -1$

\item Transform: $y'' + 3y' + 2y = e^{-t}$, $y(0) = 0$, $y'(0) = 1$

\item Convert the IVP: $t^2y'' - 2ty' + 2y = 0$, $y(1) = 1$, $y'(1) = 2$ (for $t > 0$)

\item Set up the system for: $y^{(4)} + 4y'' + 4y = 0$ with $y(0) = y'(0) = y''(0) = 0$, $y'''(0) = 1$

\item Convert: $y'' + (1 - \frac{1}{4t^2})y = 0$, $y(\pi) = 0$, $y'(\pi) = 1$
\end{enumerate}

\section*{Part E: Theoretical Problems (4 problems)}

\begin{enumerate}[resume]
\item Prove that the characteristic polynomial of a companion matrix equals the characteristic equation of the original ODE.

\item Show that if $y(t)$ solves $y^{(n)} + a_{n-1}y^{(n-1)} + \cdots + a_0y = 0$, then $\mathbf{x}(t) = [y, y', \ldots, y^{(n-1)}]^T$ solves $\mathbf{x}' = A\mathbf{x}$ where $A$ is the companion matrix.

\item Prove that the companion matrix for a constant coefficient equation has $n$ linearly independent eigenvectors if and only if all characteristic roots are distinct.

\item Show that the determinant of a companion matrix equals $(-1)^{n+1}a_0$.
\end{enumerate}

\section*{Part F: Exam-Style Problems (5 problems)}

\begin{enumerate}[resume]
\item (Prof. Ditkowski style) Given $y''' - 3y'' + 3y' - y = 0$:
\begin{enumerate}[label=(\alph*)]
\item Write the companion matrix
\item Find its eigenvalues
\item Explain the connection to the general solution
\end{enumerate}

\item Convert the system and solve for eigenvalues:
$$y^{(4)} + 5y'' + 4y = 0$$

\item A mass-spring-damper system satisfies $m\ddot{x} + c\dot{x} + kx = F(t)$.
\begin{enumerate}[label=(\alph*)]
\item Convert to first-order form with $m=1$, $c=2$, $k=5$
\item Write the companion matrix
\item Find conditions on $c$ for complex eigenvalues
\end{enumerate}

\item Given the companion matrix $A = \begin{bmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ -\alpha & -\beta & -\gamma \end{bmatrix}$:
\begin{enumerate}[label=(\alph*)]
\item Write the scalar ODE
\item Find $\alpha, \beta, \gamma$ so that $e^{t}, e^{2t}, e^{3t}$ are solutions
\item Verify using eigenvalues
\end{enumerate}

\item (Comprehensive) The equation $y''' + py' + qy = 0$ has solutions $e^{t}, e^{-t}, e^{2t}$.
\begin{enumerate}[label=(\alph*)]
\item Find $p$ and $q$
\item Write the companion matrix
\item Convert the IVP with $y(0) = 1$, $y'(0) = 0$, $y''(0) = 3$
\item Express the solution using the state vector
\end{enumerate}
\end{enumerate}

\section*{Solutions and Hints}

\textbf{Selected Solutions:}

\textbf{Problem 1:} $\mathbf{x} = \begin{bmatrix} y \\ y' \end{bmatrix}$, $A = \begin{bmatrix} 0 & 1 \\ -4 & 0 \end{bmatrix}$

\textbf{Problem 8:} The scalar ODE is $y''' + 6y'' + 11y' + 6y = 0$

\textbf{Problem 13:} $x'' + 4x' + 4x = 0$ (repeated roots at $\lambda = -2$)

\textbf{Problem 21:} Characteristic polynomial: $\det(A - \lambda I) = (-\lambda)^{n-1}(-\lambda - a_{n-1}\lambda^{n-1} - \cdots - a_0)$

\textbf{Problem 26:} Eigenvalues are $1, 1, 1$ (triple root), indicating $y = (c_1 + c_2t + c_3t^2)e^t$

\textbf{Key Insights:}
\begin{itemize}
\item Always check dimensions when setting up state vectors
\item The companion matrix structure is universal - memorize it!
\item Initial conditions transform directly: $\mathbf{x}(t_0) = [y(t_0), y'(t_0), \ldots, y^{(n-1)}(t_0)]^T$
\item Eigenvalues of companion matrix = roots of characteristic equation
\end{itemize}

\end{document}
```

## **Part 4: NotebookLM Instructions**

### **How to Use These Materials with NotebookLM**

**Preparation Steps:**
1. Save all three LaTeX documents as PDFs after compilation
2. Create a new NotebookLM notebook titled "ODE Lesson 26 - System Conversion"
3. Upload the audio script, theory document, and practice problems as separate sources

**Audio Generation Settings:**
- Select "Conversational" tone
- Enable "Educational" mode if available
- Set pace to "Moderate" for mathematical content
- Request emphasis on:
  - Companion matrix pattern
  - Sign conventions
  - Initial condition conversion
  - Common exam mistakes

**Study Sequence:**
1. **First Pass (30 minutes):**
   - Listen to audio while following the theory document
   - Focus on understanding the state vector concept
   - Practice writing companion matrices for simple examples

2. **Second Pass (45 minutes):**
   - Work through Examples in theory document
   - Attempt Part A problems (basic conversions)
   - Check companion matrix structure each time

3. **Deep Practice (60 minutes):**
   - Complete Parts B and C problems
   - Focus on reverse conversion technique
   - Time yourself on companion matrix construction

4. **Advanced Work (45 minutes):**
   - Tackle Parts D and E problems
   - Understand eigenvalue connection
   - Practice with variable coefficient cases

5. **Exam Preparation (60 minutes):**
   - Complete Part F exam-style problems
   - Review all warning boxes
   - Create quick reference card for companion matrix

**Integration with Linear Algebra:**
- Review matrix multiplication before starting
- Connect eigenvalues to characteristic polynomial
- Practice determinant calculation for 3×3 matrices
- Understand matrix-vector notation

**Common Pitfalls to Avoid:**
1. Sign errors in companion matrix (bottom row is NEGATIVE)
2. Wrong coefficient ordering (goes from $a_0$ to $a_{n-1}$)
3. Incorrect state vector setup (maintain derivative order)
4. Forgetting non-homogeneous term placement
5. Initial condition conversion errors

**Quick Reference Formulas:**
- State vector: $\mathbf{x} = [y, y', ..., y^{(n-1)}]^T$
- Companion matrix last row: $[-a_0, -a_1, ..., -a_{n-1}]$
- System form: $\mathbf{x}' = A\mathbf{x} + \mathbf{F}(t)$
- Initial conditions: $\mathbf{x}(t_0) = [y(t_0), y'(t_0), ..., y^{(n-1)}(t_0)]^T$

**Prof. Ditkowski Exam Focus:**
- Companion matrix construction (appears in 80% of system problems)
- Quick conversion of 2nd and 3rd order equations
- Eigenvalue-characteristic root connection
- Initial value problem setup
- Reverse conversion technique

**Time Management for Exam:**
- Companion matrix writing: 30 seconds maximum
- Full conversion of 2nd order: 2 minutes
- Full conversion of 3rd order: 3 minutes
- Initial condition setup: 1 minute
- Always verify dimensions before proceeding

---

**Lesson 26 complete. Request 'Generate Lesson 27' for the next lesson in Block 8.**
