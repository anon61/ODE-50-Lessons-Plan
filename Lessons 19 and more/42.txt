# **Lesson 42: Lyapunov Functions and Global Stability**

## **Part 1: Audio Lesson Script**

Welcome to Lesson 42, our final lesson on nonlinear systems! Today we're learning about Lyapunov functions - one of the most powerful tools in stability analysis. This technique is absolutely crucial for Prof. Ditkowski's exam because it works even when linearization fails!

So basically, here's the brilliant idea: instead of solving the differential equations (which is usually impossible for nonlinear systems), we find a special function V(x,y) that decreases along trajectories. Think of it like this - imagine a ball rolling in a bowl. You don't need to solve for the exact path; you just need to know the bowl shape (that's V) and that the ball rolls downhill (V decreases). If the bowl has a minimum at the bottom, the ball will end up there!

Let me show you the formal setup. A Lyapunov function V(x,y) for a system ẋ = f(x,y), ẏ = g(x,y) near an equilibrium at the origin must satisfy:
1. V(0,0) = 0 (the function equals zero at equilibrium)
2. V(x,y) > 0 for all (x,y) ≠ (0,0) nearby (positive elsewhere)
3. V̇(x,y) ≤ 0 along trajectories (decreases or stays constant)

Here's the key insight - V̇ is NOT the partial derivative! It's the rate of change along trajectories:
V̇ = ∂V/∂x · ẋ + ∂V/∂y · ẏ = ∂V/∂x · f(x,y) + ∂V/∂y · g(x,y)

This is what students mess up most with Prof. Ditkowski - you compute V̇ by taking the gradient of V and dotting it with the vector field (f,g)!

Let's work through a concrete example. Consider:
ẋ = -x + y²
ẏ = -y + x²

Let's try V(x,y) = x² + y² (the standard quadratic form). First, check conditions 1 and 2: V(0,0) = 0 ✓, and V > 0 elsewhere ✓.

Now the crucial part - compute V̇:
V̇ = 2x·ẋ + 2y·ẏ
   = 2x(-x + y²) + 2y(-y + x²)
   = -2x² + 2xy² - 2y² + 2x²y
   = -2(x² + y²) + 2xy(x + y)

Near the origin where x,y are small, the quadratic terms dominate: V̇ ≈ -2(x² + y²) < 0. So the origin is asymptotically stable!

But wait - here's where Lyapunov really shines. Remember from Lesson 41 that if we have purely imaginary eigenvalues, Hartman-Grobman fails? Lyapunov functions can still work! Consider:
ẋ = -y + x³
ẏ = x + y³

The linearization has eigenvalues ±i (non-hyperbolic). But try V = x² + y²:
V̇ = 2x(-y + x³) + 2y(x + y³)
   = -2xy + 2x⁴ + 2xy + 2y⁴
   = 2(x⁴ + y⁴) > 0 for (x,y) ≠ (0,0)

Since V̇ > 0, the origin is actually UNSTABLE! Linearization would have been inconclusive, but Lyapunov gives us the definitive answer.

Now, here's a pro tip for constructing Lyapunov functions. For most problems Prof. Ditkowski gives, try these in order:
1. V = ax² + cy² (quadratic form)
2. V = ax² + bxy + cy² (general quadratic)
3. V = x² + y² + higher order terms
4. For gradient systems, use the potential function itself!

Let me show you that last one - it's a gift when you recognize it! If the system is:
ẋ = -∂U/∂x
ẏ = -∂U/∂y

Then V = U is automatically a Lyapunov function because:
V̇ = ∂U/∂x · ẋ + ∂U/∂y · ẏ = -（∂U/∂x)² - (∂U/∂y)² ≤ 0

Physical interpretation? U is the potential energy, and the system always moves to decrease energy!

Here's another crucial concept - the difference between Lyapunov stable and asymptotically stable:
- If V̇ ≤ 0: Lyapunov stable (trajectories don't escape)
- If V̇ < 0 for (x,y) ≠ (0,0): Asymptotically stable (trajectories converge)

The equality case V̇ = 0 is subtle. That's where LaSalle's principle comes in! It says trajectories approach the largest invariant set where V̇ = 0. Often, this is just the equilibrium itself, upgrading stability to asymptotic stability.

Let's do a classic example - the damped pendulum:
ẋ = y
ẏ = -sin(x) - cy (with c > 0)

Try the energy function V = (1-cos(x)) + y²/2:
- V(0,0) = 0 ✓
- V > 0 for small (x,y) ≠ (0,0) ✓
- V̇ = sin(x)·y + y(-sin(x) - cy) = -cy² ≤ 0

So we have Lyapunov stability. But LaSalle says more! Where does V̇ = 0? Only when y = 0. On the x-axis with y = 0, we have ẋ = 0 and ẏ = -sin(x), so trajectories leave immediately unless sin(x) = 0. The only invariant set is the origin itself, so we actually have asymptotic stability!

Now, let's talk about global versus local stability. So far, we've been checking stability near the origin. But if V(x,y) → ∞ as ||(x,y)|| → ∞ (called radial unboundedness) and V̇ < 0 everywhere except the origin, then we have GLOBAL asymptotic stability. Every trajectory, no matter where it starts, converges to the origin!

Here's an exam strategy: when Prof. Ditkowski says "Using the Lyapunov function V = ...", he's giving you a gift! Just verify the three conditions and compute V̇. But when he says "Find a Lyapunov function," start with simple quadratics and work up.

Common mistakes to avoid:
1. Forgetting V must be positive away from equilibrium
2. Computing ∂V/∂t instead of V̇ along trajectories
3. Missing that V̇ = 0 doesn't mean unstable
4. Not checking V(0,0) = 0
5. Using V̇ < 0 at origin (it's always zero there!)

The memory device I use: "PD-Negative" - Positive Definite V, Negative (semi)Definite V̇.

One more powerful application - estimating basins of attraction! If V ≤ c defines a closed curve around the origin and V̇ < 0 inside except at origin, then that region is contained in the basin of attraction. This gives guaranteed convergence regions!

Remember, Lyapunov functions are your secret weapon when linearization fails or when you need global information. Master this technique - it's worth big points on the exam!

## **Part 2: LaTeX Theory Document**

```latex
\documentclass[12pt]{article}
\usepackage{amsmath, amssymb, amsthm, tikz, pgfplots}
\usepackage{geometry, enumitem, mdframed, array, xcolor}
\geometry{margin=1in}

% Custom environments
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{method}{Method}
\newtheorem{example}{Example}
\newmdenv[linecolor=blue,linewidth=2pt]{keypoint}
\newmdenv[linecolor=red,linewidth=2pt]{warning}
\newmdenv[linecolor=green,linewidth=2pt]{insight}
\newmdenv[linecolor=purple,linewidth=2pt]{examtip}
\newmdenv[linecolor=orange,linewidth=2pt]{construction}

\title{Lesson 42: Lyapunov Functions and Global Stability\\
\large ODE 1 - Prof. Adi Ditkowski}
\author{Nonlinear Systems Analysis}
\date{}

\begin{document}
\maketitle

\section{Lyapunov Stability Concepts}

\begin{definition}[Lyapunov Stability]
The equilibrium point $\mathbf{x} = \mathbf{0}$ of $\dot{\mathbf{x}} = \mathbf{f}(\mathbf{x})$ is:
\begin{itemize}
    \item \textbf{Lyapunov stable} if for every $\epsilon > 0$, there exists $\delta > 0$ such that:
    $$||\mathbf{x}(0)|| < \delta \implies ||\mathbf{x}(t)|| < \epsilon \text{ for all } t \geq 0$$

    \item \textbf{Asymptotically stable} if it is Lyapunov stable AND there exists $\delta_0 > 0$ such that:
    $$||\mathbf{x}(0)|| < \delta_0 \implies \lim_{t \to \infty} \mathbf{x}(t) = \mathbf{0}$$

    \item \textbf{Globally asymptotically stable} if it is asymptotically stable for ALL initial conditions:
    $$\lim_{t \to \infty} \mathbf{x}(t) = \mathbf{0} \text{ for all } \mathbf{x}(0) \in \mathbb{R}^2$$
\end{itemize}
\end{definition}

\begin{keypoint}
\textbf{Intuitive Understanding:}
\begin{itemize}
    \item Lyapunov stable: "Stay nearby forever"
    \item Asymptotically stable: "Stay nearby and converge"
    \item Globally asymptotically stable: "Converge from anywhere"
\end{itemize}
\end{keypoint}

\section{Lyapunov Functions}

\begin{definition}[Lyapunov Function]
A continuously differentiable function $V: \mathbb{R}^2 \to \mathbb{R}$ is a \textbf{Lyapunov function} for the system $\dot{x} = f(x,y)$, $\dot{y} = g(x,y)$ at the origin if:
\begin{enumerate}
    \item $V(0,0) = 0$
    \item $V(x,y) > 0$ for all $(x,y) \neq (0,0)$ in some neighborhood
    \item $\dot{V}(x,y) \leq 0$ along trajectories in that neighborhood
\end{enumerate}
where the derivative along trajectories is:
$$\dot{V} = \frac{\partial V}{\partial x}f(x,y) + \frac{\partial V}{\partial y}g(x,y) = \nabla V \cdot \mathbf{f}$$
\end{definition}

\begin{warning}
\textbf{Critical Distinction:}
$$\dot{V} \neq \frac{\partial V}{\partial t}$$
Since $V$ doesn't explicitly depend on time, $\frac{\partial V}{\partial t} = 0$. Instead:
$$\dot{V} = \frac{dV}{dt}\bigg|_{\text{along trajectories}} = \nabla V \cdot \mathbf{f}$$
\end{warning}

\section{Main Stability Theorems}

\begin{theorem}[Lyapunov's Direct Method]
For the equilibrium at the origin:
\begin{enumerate}
    \item If there exists a Lyapunov function with $\dot{V} \leq 0$, then the origin is \textbf{Lyapunov stable}
    \item If additionally $\dot{V} < 0$ for $(x,y) \neq (0,0)$, then the origin is \textbf{asymptotically stable}
    \item If additionally $V(x,y) \to \infty$ as $||(x,y)|| \to \infty$ (radial unboundedness), then the origin is \textbf{globally asymptotically stable}
\end{enumerate}
\end{theorem}

\begin{theorem}[Instability Theorem]
If there exists a function $V$ with $V(0,0) = 0$ and:
\begin{itemize}
    \item $V$ can take positive values arbitrarily close to the origin
    \item $\dot{V} > 0$ where $V > 0$
\end{itemize}
then the origin is \textbf{unstable}.
\end{theorem}

\section{LaSalle's Invariance Principle}

\begin{theorem}[LaSalle's Principle]
Let $V$ be a Lyapunov function with $\dot{V} \leq 0$. Define:
$$E = \{(x,y) : \dot{V}(x,y) = 0\}$$
Let $M$ be the largest invariant set contained in $E$. Then all trajectories starting in a neighborhood of the origin approach $M$ as $t \to \infty$.
\end{theorem}

\begin{insight}
LaSalle's principle often upgrades Lyapunov stability to asymptotic stability! If the only invariant set in $E$ is the origin itself, then we have asymptotic stability even when $\dot{V} \leq 0$ (not strictly negative).
\end{insight}

\section{Construction Methods}

\begin{construction}
\textbf{Standard Approaches for Finding Lyapunov Functions:}

\begin{enumerate}
    \item \textbf{Quadratic Forms:} Try $V = ax^2 + cy^2$ with $a, c > 0$

    \item \textbf{General Quadratic:} Try $V = ax^2 + bxy + cy^2$ with:
    $$a > 0, \quad c > 0, \quad ac - b^2/4 > 0$$

    \item \textbf{Energy Methods:} For mechanical systems, use:
    $$V = \text{kinetic energy} + \text{potential energy}$$

    \item \textbf{Gradient Systems:} If $\dot{\mathbf{x}} = -\nabla U(\mathbf{x})$, use $V = U$

    \item \textbf{First Integrals:} If $H(x,y)$ is conserved, modifications of $H$ often work

    \item \textbf{Trial and Error:} Combine terms based on system structure
\end{enumerate}
\end{construction}

\section{Complete Examples}

\begin{example}[Quadratic Lyapunov Function]
Consider the system:
$$\dot{x} = -x^3 + xy^2, \quad \dot{y} = -y^3 + x^2y$$

Try $V(x,y) = x^2 + y^2$:

\textbf{Check conditions:}
\begin{enumerate}
    \item $V(0,0) = 0$ \checkmark
    \item $V(x,y) = x^2 + y^2 > 0$ for $(x,y) \neq (0,0)$ \checkmark
    \item Compute $\dot{V}$:
    \begin{align}
    \dot{V} &= 2x\dot{x} + 2y\dot{y}\\
    &= 2x(-x^3 + xy^2) + 2y(-y^3 + x^2y)\\
    &= -2x^4 + 2x^2y^2 - 2y^4 + 2x^2y^2\\
    &= -2(x^4 + y^4) + 4x^2y^2\\
    &= -2(x^4 + y^4 - 2x^2y^2)\\
    &= -2(x^2 - y^2)^2 \leq 0
    \end{align}
\end{enumerate}

So the origin is Lyapunov stable. For asymptotic stability, apply LaSalle:
$\dot{V} = 0$ only when $x^2 = y^2$, i.e., $x = \pm y$.

On the line $x = y$: $\dot{x} = 0$, $\dot{y} = 0$ only at origin.
On the line $x = -y$: $\dot{x} = -2x^3$, $\dot{y} = 2y^3$, so trajectories leave unless at origin.

Therefore, $M = \{(0,0)\}$ and the origin is asymptotically stable.
\end{example}

\begin{example}[Energy Function for Pendulum]
Damped pendulum: $\ddot{\theta} + c\dot{\theta} + \sin\theta = 0$

As a system: $\dot{x} = y$, $\dot{y} = -\sin x - cy$ (where $x = \theta$, $y = \dot{\theta}$)

Energy function: $V(x,y) = \frac{1}{2}y^2 + (1 - \cos x)$

\textbf{Analysis:}
\begin{enumerate}
    \item $V(0,0) = 0$ \checkmark
    \item For small $x$: $1 - \cos x \approx \frac{x^2}{2} > 0$, so $V > 0$ near origin \checkmark
    \item $\dot{V} = y\dot{y} + \sin x \cdot \dot{x} = y(-\sin x - cy) + \sin x \cdot y = -cy^2 \leq 0$
\end{enumerate}

By LaSalle: $\dot{V} = 0$ when $y = 0$. The invariant set on $\{y = 0\}$ is just the equilibria. Near the origin, this is only $(0,0)$, giving asymptotic stability.
\end{example}

\section{Basin of Attraction}

\begin{definition}[Basin of Attraction]
The basin of attraction of an asymptotically stable equilibrium $\mathbf{x}^*$ is:
$$\mathcal{B}(\mathbf{x}^*) = \{\mathbf{x}_0 : \lim_{t \to \infty} \phi(t, \mathbf{x}_0) = \mathbf{x}^*\}$$
where $\phi(t, \mathbf{x}_0)$ is the solution starting at $\mathbf{x}_0$.
\end{definition}

\begin{method}[Estimating Basins with Lyapunov Functions]
If $V$ is a Lyapunov function with $\dot{V} < 0$ for $\mathbf{x} \neq \mathbf{0}$, and $\Omega_c = \{\mathbf{x} : V(\mathbf{x}) \leq c\}$ is bounded and contains only the origin as an equilibrium, then $\Omega_c \subseteq \mathcal{B}(\mathbf{0})$.
\end{method}

\section{Comparison: Linearization vs Lyapunov}

\begin{center}
\begin{tabular}{|l|l|l|}
\hline
\textbf{Aspect} & \textbf{Linearization} & \textbf{Lyapunov} \\
\hline
Scope & Local only & Local or global \\
Applicability & Hyperbolic equilibria & Any equilibrium \\
Information & Qualitative behavior & Stability + basin \\
Construction & Automatic (Jacobian) & Requires creativity \\
Limitations & Fails at centers & May not exist/find \\
\hline
\end{tabular}
\end{center}

\begin{examtip}
\textbf{Prof. Ditkowski's Exam Strategy:}
\begin{enumerate}
    \item If given $V$, just verify conditions and compute $\dot{V}$
    \item If asked to find $V$:
    \begin{itemize}
        \item Start with $V = x^2 + y^2$
        \item Try $V = ax^2 + cy^2$ with suitable $a,c$
        \item Look for physical energy if mechanical system
        \item Check if gradient system
    \end{itemize}
    \item Always apply LaSalle when $\dot{V} \leq 0$ (not strictly negative)
    \item State stability conclusion explicitly
\end{enumerate}
\end{examtip}

\section{Summary Algorithm}

\begin{mdframed}[linecolor=black, linewidth=1pt]
\textbf{Lyapunov Analysis Procedure:}
\begin{enumerate}
    \item Identify/construct candidate $V(x,y)$
    \item Verify $V(0,0) = 0$
    \item Check $V(x,y) > 0$ for $(x,y) \neq (0,0)$ nearby
    \item Compute $\dot{V} = \frac{\partial V}{\partial x}f + \frac{\partial V}{\partial y}g$
    \item Analyze sign of $\dot{V}$:
    \begin{itemize}
        \item $\dot{V} \leq 0$: Lyapunov stable
        \item $\dot{V} < 0$ (except origin): Asymptotically stable
        \item $\dot{V} > 0$ somewhere: Check instability theorem
    \end{itemize}
    \item If $\dot{V} \leq 0$, apply LaSalle's principle
    \item Check radial unboundedness for global stability
\end{enumerate}
\end{mdframed}

\end{document}
```

## **Part 3: LaTeX Practice Problems**

```latex
\documentclass[12pt]{article}
\usepackage{amsmath, amssymb, amsthm, enumitem, geometry}
\usepackage{mdframed, xcolor}
\geometry{margin=1in}

\newmdenv[linecolor=blue,linewidth=1pt]{hint}
\newcommand{\solution}[1]{\textcolor{blue}{\textbf{Solution Hint:} #1}}

\title{Lesson 42: Practice Problems\\
\large Lyapunov Functions and Global Stability}
\author{ODE 1 - Prof. Adi Ditkowski}
\date{}

\begin{document}
\maketitle

\section*{Part A: Verifying Lyapunov Functions (5 problems)}

\begin{enumerate}
\item Verify that $V(x,y) = x^2 + 2y^2$ is a Lyapunov function for:
$$\dot{x} = -x + y^2, \quad \dot{y} = -x - y$$
What can you conclude about stability?
\solution{Compute $\dot{V} = 2x\dot{x} + 4y\dot{y}$. Check sign near origin.}

\item Given $V(x,y) = x^4 + y^4$, determine if it's a valid Lyapunov function for:
$$\dot{x} = -x^3, \quad \dot{y} = -y^3$$
\solution{Check all three conditions. Note $\dot{V} = -4(x^6 + y^6)$.}

\item For the system $\dot{x} = y$, $\dot{y} = -x - y$, show that $V = x^2 + xy + y^2$ is a Lyapunov function.
\solution{First verify $V > 0$ using completing the square.}

\item Consider $V(x,y) = \frac{1}{2}(x^2 + y^2) + x^2y^2$. For what systems could this be a Lyapunov function?
\solution{Work backwards: what $f,g$ make $\dot{V} \leq 0$?}

\item Verify whether $V = e^{x^2+y^2} - 1$ satisfies the conditions for a Lyapunov function near the origin for:
$$\dot{x} = -x, \quad \dot{y} = -y$$
\solution{Check $V(0,0) = 0$ and positivity. Compute $\dot{V}$ carefully.}
\end{enumerate}

\section*{Part B: Computing $\dot{V}$ (6 problems)}

\begin{enumerate}[resume]
\item For $V = x^2 + y^2$ and the system:
$$\dot{x} = -x + x^2y, \quad \dot{y} = -2y + xy^2$$
compute $\dot{V}$ and determine stability.
\solution{$\dot{V} = 2x\dot{x} + 2y\dot{y}$. Factor carefully.}

\item Given $V = ax^2 + cy^2$, find conditions on $a,c$ for stability of:
$$\dot{x} = -x + y, \quad \dot{y} = -x - y$$
\solution{Compute $\dot{V}$ in terms of $a,c$. When is it negative definite?}

\item For the Van der Pol oscillator with $\mu > 0$:
$$\dot{x} = y, \quad \dot{y} = -x + \mu(1-x^2)y$$
Show that $V = x^2 + y^2$ gives $\dot{V} = 2\mu(1-x^2)y^2$.
\solution{Direct computation. Note sign depends on $x^2$ vs 1.}

\item Compute $\dot{V}$ for $V = \frac{1}{2}y^2 + (1-\cos x)$ along trajectories of:
$$\dot{x} = y, \quad \dot{y} = -\sin x$$
\solution{This is the undamped pendulum. What does $\dot{V} = 0$ mean?}

\item For $V = x^2 - 2xy + 2y^2$ and:
$$\dot{x} = -x + y, \quad \dot{y} = -x - y$$
compute $\dot{V}$ and interpret.
\solution{Careful with the cross term $-2xy$.}

\item Given a general quadratic $V = ax^2 + bxy + cy^2$, derive the formula for $\dot{V}$ in terms of $f(x,y)$ and $g(x,y)$.
\solution{$\dot{V} = (2ax + by)f + (bx + 2cy)g$.}
\end{enumerate}

\section*{Part C: Constructing Lyapunov Functions (5 problems)}

\begin{enumerate}[resume]
\item Find a Lyapunov function for:
$$\dot{x} = -x^3, \quad \dot{y} = -y^3$$
\solution{Try $V = x^{2n} + y^{2n}$ for appropriate $n$.}

\item Construct a Lyapunov function to prove stability of:
$$\dot{x} = -x + y^2, \quad \dot{y} = -y + x^2$$
when $x,y$ are small.
\solution{Try $V = ax^2 + cy^2$ with $a \neq c$.}

\item For the gradient system with potential $U = x^4 + y^4 - x^2 - y^2$:
$$\dot{x} = -\frac{\partial U}{\partial x}, \quad \dot{y} = -\frac{\partial U}{\partial y}$$
find a Lyapunov function for the equilibrium at origin.
\solution{Shift $U$ so minimum is at origin.}

\item Find a Lyapunov function for the damped oscillator:
$$\dot{x} = y, \quad \dot{y} = -\omega^2 x - 2\zeta\omega y$$
with $\omega > 0$ and $\zeta > 0$.
\solution{Try energy-like: $V = \frac{1}{2}(\omega^2x^2 + y^2)$.}

\item Construct a Lyapunov function for:
$$\dot{x} = y - x^3, \quad \dot{y} = -x - y^3$$
\solution{Try $V = x^2 + y^2$ first. If that fails, try $V = ax^2 + y^2$.}
\end{enumerate}

\section*{Part D: LaSalle's Principle (4 problems)}

\begin{enumerate}[resume]
\item For the system:
$$\dot{x} = -y^3, \quad \dot{y} = x^3$$
with $V = x^4 + y^4$:
\begin{enumerate}[label=(\alph*)]
    \item Show $\dot{V} = 0$
    \item Apply LaSalle's principle
    \item What can you conclude about stability?
\end{enumerate}
\solution{$E = \mathbb{R}^2$. Check invariant sets.}

\item Consider:
$$\dot{x} = y, \quad \dot{y} = -x - y^3$$
with $V = x^2 + y^2$:
\begin{enumerate}[label=(\alph*)]
    \item Compute $\dot{V}$
    \item Find the set $E$ where $\dot{V} = 0$
    \item Determine the largest invariant set in $E$
    \item State stability conclusion
\end{enumerate}
\solution{$\dot{V} = -2y^4 \leq 0$. $E = \{y = 0\}$.}

\item For the pendulum with friction:
$$\dot{x} = y, \quad \dot{y} = -\sin x - cy$$
Use energy $V = (1-\cos x) + \frac{1}{2}y^2$ and LaSalle to prove asymptotic stability.
\solution{$\dot{V} = -cy^2$. On $\{y=0\}$, only equilibria are invariant.}

\item Apply LaSalle to:
$$\dot{x} = -x^3 + xy^2, \quad \dot{y} = -y^3 + x^2y$$
with $V = x^2 + y^2$.
\solution{Find where $(x^2-y^2)^2 = 0$.}
\end{enumerate}

\section*{Part E: Global Stability (5 problems)}

\begin{enumerate}[resume]
\item Show that the origin is globally asymptotically stable for:
$$\dot{x} = -x - x^3, \quad \dot{y} = -y - y^3$$
\solution{Use $V = x^2 + y^2$. Check radial unboundedness.}

\item For the system:
$$\dot{x} = -x + y^2, \quad \dot{y} = -y + x^2$$
determine if the origin is globally asymptotically stable.
\solution{Check if other equilibria exist. Can't be global if there are others.}

\item Prove global asymptotic stability for:
$$\dot{x} = -x^3 - xy^2, \quad \dot{y} = -x^2y - y^3$$
\solution{Try $V = x^2 + y^2$. Show $\dot{V} < 0$ except at origin.}

\item Consider the scaled system:
$$\dot{x} = -f(x), \quad \dot{y} = -g(y)$$
where $f,g$ are odd functions with $xf(x) > 0$ for $x \neq 0$. Prove global stability.
\solution{Use $V = \int_0^x f(s)ds + \int_0^y g(s)ds$.}

\item Determine the basin of attraction for:
$$\dot{x} = -x + x^3, \quad \dot{y} = -y$$
using $V = x^2 + y^2$.
\solution{Find where $\dot{V} < 0$. Note $x^2 < 1$ needed.}
\end{enumerate}

\section*{Part F: Exam-Style Problems (5 problems)}

\begin{enumerate}[resume]
\item \textbf{[Prof. Ditkowski Style]} Consider the system:
$$\dot{x} = -x^3 + 2xy^2, \quad \dot{y} = -2x^2y - y^3$$
\begin{enumerate}[label=(\alph*)]
    \item Verify that $V = x^2 + y^2$ is a Lyapunov function
    \item Compute $\dot{V}$ explicitly
    \item Is the origin locally or globally asymptotically stable?
    \item Find the basin of attraction
\end{enumerate}
\solution{$\dot{V} = -2(x^2+y^2)^2 < 0$. Global stability follows.}

\item \textbf{[Comprehensive]} For the nonlinear oscillator:
$$\ddot{x} + (x^2 + \dot{x}^2 - 1)\dot{x} + x = 0$$
\begin{enumerate}[label=(\alph*)]
    \item Rewrite as a first-order system
    \item Show the origin is the only equilibrium
    \item Using $V = x^2 + y^2$, determine stability
    \item What happens on the unit circle $x^2 + y^2 = 1$?
\end{enumerate}
\solution{This is a Van der Pol type equation. Check $\dot{V}$ sign.}

\item \textbf{[Method Comparison]} Consider:
$$\dot{x} = y + x^3, \quad \dot{y} = -x + y^3$$
\begin{enumerate}[label=(\alph*)]
    \item Show linearization is inconclusive
    \item Try $V = x^2 + y^2$ as a Lyapunov function
    \item What does this tell us about stability?
    \item Find a different $V$ that proves instability
\end{enumerate}
\solution{Linearization gives $\pm i$. First $V$ gives $\dot{V} = 2(x^4+y^4) > 0$.}

\item \textbf{[Physical System]} A particle moves according to:
$$\dot{x} = y, \quad \dot{y} = -\nabla U(x)$$
where $U(x) = \frac{1}{4}x^4 - \frac{1}{2}x^2$.
\begin{enumerate}[label=(\alph*)]
    \item Find all equilibria
    \item Classify each using linearization where possible
    \item Use energy methods to determine stability
    \item Sketch the phase portrait
\end{enumerate}
\solution{Three equilibria. Use $V = \frac{1}{2}y^2 + U(x)$ shifted appropriately.}

\item \textbf{[Challenge]} Consider the coupled system:
$$\dot{x} = y - x^3, \quad \dot{y} = -x - y + y^2$$
\begin{enumerate}[label=(\alph*)]
    \item Find all equilibria
    \item For the origin, try to construct a Lyapunov function
    \item If $V = ax^2 + bxy + cy^2$, find conditions for stability
    \item Can you prove global results?
\end{enumerate}
\solution{Need to handle the $y^2$ term carefully. Try $V = x^2 + \alpha xy + \beta y^2$.}
\end{enumerate}

\section*{Part G: Additional Practice (5 problems)}

\begin{enumerate}[resume]
\item Show that for any positive definite matrix $P$, $V = \mathbf{x}^T P \mathbf{x}$ is a valid Lyapunov function form.

\item For the Lorenz system restricted to the $x$-$y$ plane:
$$\dot{x} = \sigma(y-x), \quad \dot{y} = rx - y$$
find a Lyapunov function when $0 < r < 1$.

\item Consider the "reversed" gradient system:
$$\dot{x} = \frac{\partial H}{\partial y}, \quad \dot{y} = -\frac{\partial H}{\partial x}$$
Show that $H$ is constant along trajectories. What does this mean for stability?

\item Prove that if $V$ is a Lyapunov function with $\dot{V} < -\alpha V$ for some $\alpha > 0$, then the origin is exponentially stable.

\item \textbf{[Research Connection]} For the system:
$$\dot{x} = -x + y^2, \quad \dot{y} = -y + x^2$$
\begin{enumerate}[label=(\alph*)]
    \item Show there are exactly 3 equilibria
    \item Find a common Lyapunov function for all three
    \item What does this imply about basins of attraction?
\end{enumerate}
\end{enumerate}

\begin{hint}
\textbf{Key Strategies for Prof. Ditkowski's Exam:}
\begin{itemize}
    \item If given $V$, always verify ALL three conditions
    \item Remember: $\dot{V} = \nabla V \cdot \mathbf{f}$, NOT $\partial V/\partial t$
    \item When $\dot{V} \leq 0$, always apply LaSalle
    \item For global stability, check for other equilibria first
    \item Standard forms: $V = x^2 + y^2$ or $V = ax^2 + cy^2$
    \item Energy/gradient systems have natural Lyapunov functions
    \item State conclusions explicitly: "locally/globally asymptotically stable"
\end{itemize}
\end{hint}

\end{document}
```

## **Part 4: NotebookLM Instructions**

### **How to Use These Materials with NotebookLM**

**Step 1: File Organization**
- Save Audio Script as "Lesson42_Audio.txt"
- Compile Theory document as "Lesson42_Theory.pdf"
- Compile Practice Problems as "Lesson42_Practice.pdf"
- Create folder: "Lesson 42 - Lyapunov Functions"

**Step 2: NotebookLM Configuration**
1. Create notebook: "ODE Lesson 42: Lyapunov Methods"
2. Upload all three documents
3. Add note: "Focus on construction techniques and LaSalle's principle"
4. Tag: "Alternative to linearization"

**Step 3: Audio Enhancement Requests**
When generating audio, request:
- Clear distinction between V̇ and ∂V/∂t
- Physical interpretations (energy, potential)
- Step-by-step construction examples
- When to use Lyapunov vs linearization

**Step 4: Strategic Study Plan**

**Phase 1 - Foundation (1.5 hours):**
- Read theory sections 1-3
- Focus on Definition 2 and Theorem 1
- Create flashcard: "Lyapunov conditions"
- Work problems 1-5 (verification)

**Phase 2 - Computation (1.5 hours):**
- Master computing V̇
- Complete problems 6-11
- Listen to audio while solving
- Create formula sheet for V̇

**Phase 3 - Construction (2 hours):**
- Study construction methods
- Attempt problems 12-16 without hints
- Review theory section 5
- Practice standard forms

**Phase 4 - Advanced Topics (1.5 hours):**
- Learn LaSalle's principle
- Work problems 17-20
- Study global stability
- Complete problems 21-25

**Phase 5 - Integration (1 hour):**
- Exam-style problems 26-30
- Compare all three methods (linearization, H-G, Lyapunov)
- Review when each applies

**Step 5: Critical Distinctions**

| Concept | Common Error | Correct Understanding |
|---------|--------------|----------------------|
| V̇ | Using ∂V/∂t | V̇ = ∇V · f |
| Stability | V̇ < 0 everywhere | V̇ < 0 except at origin |
| LaSalle | Ignoring when V̇ = 0 | Find invariant set in E |
| Global | Assuming from local | Check radial unboundedness |

**Step 6: Lyapunov Function Cookbook**

```
STANDARD LYAPUNOV FUNCTIONS
1. Basic quadratic: V = x² + y²
2. Weighted: V = ax² + cy² (choose a,c)
3. With cross term: V = ax² + bxy + cy²
4. Energy: V = ½(ẋ² + ω²x²)
5. Gradient system: V = U(x,y)
6. Modified energy: V = Energy + perturbation
```

**Step 7: Exam Preparation Checklist**

**Before the exam, ensure you can:**
- [ ] State three conditions for Lyapunov function
- [ ] Compute V̇ correctly every time
- [ ] Apply LaSalle's principle
- [ ] Recognize when to use Lyapunov vs linearization
- [ ] Construct V for simple systems
- [ ] Distinguish local vs global stability

**Step 8: Integration with Previous Lessons**

**When to use each method:**
1. **Linearization (Lesson 40):** First attempt, hyperbolic equilibria
2. **Hartman-Grobman (Lesson 41):** Verify linearization validity
3. **Lyapunov (Lesson 42):** When linearization fails or need global info

**Combined Strategy:**
1. Try linearization first (quick)
2. Check hyperbolicity (H-G)
3. If non-hyperbolic, use Lyapunov
4. For global analysis, always Lyapunov

**Step 9: Time Management**
- Theory study: 2 hours
- Practice A-C: 1.5 hours
- Practice D-F: 2 hours
- Audio + review: 1.5 hours
- Total: 7 hours for mastery

**Step 10: Prof. Ditkowski's Exam Patterns**

**Typical Questions:**
1. "Verify that V = ___ is a Lyapunov function" (15 points)
2. "Find a Lyapunov function for..." (20 points)
3. "Using energy methods, determine stability" (15 points)
4. "Apply LaSalle's principle to..." (10 points)

**Grading Focus:**
- Correct computation of V̇ (40%)
- Verifying all conditions (30%)
- Proper application of theorems (20%)
- Clear stability conclusion (10%)

**Common Partial Credit Opportunities:**
- Show V(0,0) = 0 ✓ (2 points)
- Show V > 0 elsewhere ✓ (3 points)
- Compute ∇V correctly (5 points)
- Write V̇ formula correctly (5 points)
- Even if final answer wrong!

**Memory Aids:**
- "PD-ND": Positive Definite V, Negative Definite V̇
- "GAS needs RU": Global Asymptotic Stability needs Radial Unboundedness
- "LaSalle upgrades": Turns ≤ into

**Quick Decision Tree:**
```
Is equilibrium hyperbolic?
├─ YES → Use linearization (Lesson 40)
│   └─ Apply Hartman-Grobman (Lesson 41)
└─ NO → Try Lyapunov (Lesson 42)
    ├─ Found V? → Determine stability
    └─ Can't find V? → Try other methods
```

**Final Tips:**
1. Lyapunov ALWAYS works in principle (but finding V is hard)
2. If Prof. gives you V, that's 80% of the problem solved
3. For mechanical systems, try energy first
4. Don't forget LaSalle when V̇ ≤ 0
5. Global stability requires checking for other equilibria

---

**Block 11 Complete!** You now have all three lessons:
- Lesson 40: Critical Points and Linearization
- Lesson 41: Hartman-Grobman Theorem
- Lesson 42: Lyapunov Functions and Global Stability

These form a complete toolkit for analyzing nonlinear systems. Master all three methods, as Prof. Ditkowski expects you to know when and how to apply each technique. Good luck with your studies!
