# **Lesson 39: 3D Systems and Higher Dimensions**

## **Part 1: Audio Lesson Script**

Alright, welcome to Lesson 39 - our final lesson on phase portraits! We're stepping up to 3D and beyond. This is where things get really fascinating but also more challenging to visualize. Prof. Ditkowski usually has one 3D problem on the exam, so let's master this!

So basically, everything we learned about 2D systems extends to 3D, but with some twists. In 3D, we have three eigenvalues, and the combinations give us richer behavior. Think about it - in 2D, trajectories can't cross, so they're pretty constrained. In 3D, trajectories have more room to maneuver around each other!

Here's the key insight: in 3D, eigenvalues still determine everything, but now we can have mixed behaviors. You might have two negative eigenvalues and one positive - that gives you a 2D stable manifold and a 1D unstable manifold. It's like having a plane that attracts and a line that repels!

Let me show you the main 3D equilibrium types. First, if all three eigenvalues are real and negative, you get a stable node - everything converges to the origin. All positive? Unstable node - everything escapes. But here's where it gets interesting: what if you have two negative and one positive eigenvalue? That's a saddle point, but not like 2D saddles!

This 3D saddle has a 2D stable manifold (the eigenspace for the two negative eigenvalues) and a 1D unstable manifold. Picture a plane where trajectories converge, with a line perpendicular to it where they escape. Trajectories spiral down toward the plane, then shoot out along the line!

Now, complex eigenvalues in 3D are super cool. Say you have λ₁ = -1 and λ₂,₃ = -0.5 ± 2i. The complex pair creates rotation in a plane, while the real eigenvalue adds convergence perpendicular to that plane. You get trajectories that spiral inward while also approaching the rotation plane - like water going down a drain!

Here's a concrete example:
```
A = [-1  0   0]
    [ 0 -0.5  2]
    [ 0 -2  -0.5]
```

The eigenvalues are -1 (real) and -0.5 ± 2i (complex pair). This creates a stable spiral-node. Trajectories rotate in the y-z plane while converging along the x-axis. Beautiful!

Let me teach you about projection techniques - this is crucial for visualization. Since we can't really draw in 3D easily, we project onto 2D planes. The three standard projections are:
- x-y plane: set z = 0, see shadow from above
- x-z plane: set y = 0, see shadow from the side
- y-z plane: set x = 0, see shadow from the front

Each projection shows different aspects of the flow. A 3D spiral might look like a 2D spiral in one projection but a node in another!

Poincaré sections are another powerful tool. Instead of looking at the entire 3D flow, we look at where trajectories pierce through a 2D surface. Imagine putting a sheet of paper in your 3D phase space and marking dots where trajectories pass through. The pattern of dots reveals the dynamics!

For example, if trajectories are periodic, you'll see the same points over and over. If they're quasi-periodic, you'll see points filling up curves. And if it's chaotic... well, you'll see a mess that somehow has structure - that's a strange attractor!

Speaking of chaos, here's a preview: the Lorenz system, which Prof. Ditkowski sometimes mentions:
```
ẋ = σ(y - x)
ẏ = rx - y - xz
ż = xy - bz
```

For certain parameter values, this creates the famous butterfly attractor - trajectories that never repeat but stay bounded, creating a fractal structure. Mind-blowing stuff!

Now, let's talk about invariant manifolds in 3D. Remember in 2D, saddles had stable and unstable manifolds along eigenvector directions? In 3D, these can be:
- 1D curves (one real eigenvalue)
- 2D surfaces (two real eigenvalues with same sign)
- 2D spiral surfaces (complex eigenvalue pair)

The stable manifold theorem says trajectories starting on the stable manifold stay on it and approach the equilibrium. Same for unstable manifolds but going backward in time.

Here's an exam tip: Prof. Ditkowski loves asking you to find these manifolds. For a 3D system with eigenvalues λ₁ < 0 < λ₂ < λ₃, the stable manifold is span{v₁} (1D), and the unstable manifold is span{v₂, v₃} (2D). Always state the dimension!

For higher dimensions (4D and beyond), we can't visualize directly, but the math still works! You classify using eigenvalues:
- All Re(λᵢ) < 0: asymptotically stable
- Any Re(λᵢ) > 0: unstable
- All Re(λᵢ) ≤ 0 with some = 0: marginally stable

The dimension of the stable manifold equals the number of eigenvalues with negative real parts. The unstable manifold dimension equals those with positive real parts. The center manifold corresponds to zero real parts.

Numerical tools become essential in higher dimensions. MATLAB, Python, or Mathematica can compute eigenvalues, plot projections, and animate trajectories. But understanding what to look for is key!

Here's a practical approach for 3D problems on exams:
1. Find equilibria (usually just origin for linear systems)
2. Compute all three eigenvalues
3. Classify based on eigenvalue signs and types
4. Identify stable/unstable/center manifold dimensions
5. Describe behavior in words (since drawing is hard)
6. Maybe sketch one or two key projections

Common mistakes in 3D:
- Forgetting that complex eigenvalues come in pairs
- Not stating manifold dimensions
- Trying to draw too much detail
- Missing the third eigenvalue in calculations

Remember, 3D systems can have behaviors impossible in 2D:
- Stable limit cycles attracting nearby trajectories
- Torus attractors (quasi-periodic motion on a donut shape)
- Strange attractors (chaos)
- Homoclinic tangles (really complex stuff)

For Prof. Ditkowski's course, focus on linear 3D systems and their classification. Know how eigenvalues determine stability and manifold dimensions. Be able to describe behavior verbally when drawing isn't feasible.

The big picture: dimensions are just directions in phase space. Whether it's 2D, 3D, or 100D, eigenvalues tell the story. Master the concepts in 2D and 3D, and you'll understand any dimension!

## **Part 2: LaTeX Theory Document**

```latex
\documentclass[12pt]{article}
\usepackage{amsmath, amssymb, amsthm, tikz, pgfplots}
\usepackage{geometry, enumitem, mdframed, array, xcolor}
\usepackage{tikz-3dplot}
\geometry{margin=1in}

% Custom environments
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{classification}{Classification}
\newtheorem{example}{Example}
\newmdenv[linecolor=blue,linewidth=2pt]{keypoint}
\newmdenv[linecolor=red,linewidth=2pt]{warning}
\newmdenv[linecolor=green,linewidth=2pt]{insight}
\newmdenv[linecolor=purple,linewidth=2pt]{examtip}
\newmdenv[linecolor=orange,linewidth=2pt]{visualization}

\title{3D Systems and Higher Dimensions}
\author{ODE 1 - Lesson 39}
\date{}

\begin{document}
\maketitle

\section{3D Linear Systems}

Consider the 3D linear system:
$$\dot{\mathbf{x}} = A\mathbf{x}, \quad \text{where } A \in \mathbb{R}^{3 \times 3}$$

\begin{keypoint}
\textbf{Fundamental Principle:}
The behavior is completely determined by the eigenvalues $\lambda_1, \lambda_2, \lambda_3$ of $A$.
\begin{itemize}
    \item Real eigenvalues → exponential behavior
    \item Complex pair → rotation in a plane
    \item All three eigenvalues cannot be complex (odd dimension!)
\end{itemize}
\end{keypoint}

\section{Classification of 3D Equilibria}

\begin{classification}[3D Equilibrium Types]
\begin{center}
\begin{tabular}{|l|c|c|p{5cm}|}
\hline
\textbf{Type} & \textbf{Eigenvalues} & \textbf{Stability} & \textbf{Behavior} \\
\hline
\hline
Stable Node & $\lambda_i < 0$ (all real) & Asymp. Stable & All trajectories converge \\
\hline
Unstable Node & $\lambda_i > 0$ (all real) & Unstable & All trajectories diverge \\
\hline
Saddle (1-2) & 1 pos., 2 neg. & Unstable & 1D unstable, 2D stable manifold \\
\hline
Saddle (2-1) & 2 pos., 1 neg. & Unstable & 2D unstable, 1D stable manifold \\
\hline
Spiral-Node (S) & 1 real neg., 2 complex (Re$<$0) & Asymp. Stable & Spiral in plane, converge perpendicular \\
\hline
Spiral-Node (U) & 1 real pos., 2 complex (Re$>$0) & Unstable & Spiral out plane, diverge perpendicular \\
\hline
Spiral-Saddle & 1 real, 2 complex (mixed signs) & Unstable & Spiral in one direction, escape another \\
\hline
Center-Line & 1 real = 0, 2 pure imag. & Marginally Stable & Circles in plane, line of equilibria \\
\hline
\end{tabular}
\end{center}
\end{classification}

\section{Invariant Manifolds}

\begin{definition}[Stable, Unstable, and Center Manifolds]
For an equilibrium at the origin with eigenvalues $\{\lambda_i\}$:
\begin{align}
E^s &= \text{span}\{v_i : \text{Re}(\lambda_i) < 0\} \quad \text{(Stable manifold)} \\
E^u &= \text{span}\{v_i : \text{Re}(\lambda_i) > 0\} \quad \text{(Unstable manifold)} \\
E^c &= \text{span}\{v_i : \text{Re}(\lambda_i) = 0\} \quad \text{(Center manifold)}
\end{align}
Dimensions: $\dim(E^s) + \dim(E^u) + \dim(E^c) = 3$
\end{definition}

\begin{theorem}[Manifold Dynamics]
\begin{itemize}
    \item Trajectories in $E^s$ approach origin as $t \to \infty$
    \item Trajectories in $E^u$ approach origin as $t \to -\infty$
    \item Trajectories in $E^c$ may be periodic or stationary
\end{itemize}
\end{theorem}

\section{Visualization Techniques}

\subsection{Projection Methods}

\begin{visualization}
\textbf{Standard Projections:}
\begin{itemize}
    \item \textbf{xy-projection}: View from above $(x,y,0)$
    \item \textbf{xz-projection}: View from side $(x,0,z)$
    \item \textbf{yz-projection}: View from front $(0,y,z)$
\end{itemize}
Each projection shows 2D "shadow" of 3D dynamics
\end{visualization}

\begin{example}[Projection Analysis]
System with $\lambda_1 = -1$, $\lambda_2,3 = -0.5 \pm 2i$:
\begin{itemize}
    \item xy-projection: Spiral (from complex pair)
    \item xz-projection: Node-like (real eigenvalue dominates)
    \item yz-projection: Pure spiral (complex pair only)
\end{itemize}
\end{example}

\subsection{Poincaré Sections}

\begin{definition}[Poincaré Section]
A \textbf{Poincaré section} is a lower-dimensional slice through phase space. For a 3D system, choose a 2D surface $\Sigma$ and record intersection points of trajectories with $\Sigma$.
\end{definition}

\begin{insight}
\textbf{Poincaré Map Reveals:}
\begin{itemize}
    \item Fixed point → Periodic orbit
    \item Closed curve → Quasi-periodic (torus)
    \item Strange pattern → Chaos
    \item No pattern → Transient behavior
\end{itemize}
\end{insight}

\section{Examples of 3D Systems}

\begin{example}[Complete 3D Analysis]
Consider the matrix:
$$A = \begin{pmatrix} -2 & 1 & 0 \\ 0 & -1 & 0 \\ 0 & 0 & 3 \end{pmatrix}$$

\textbf{Step 1:} Eigenvalues are $\lambda_1 = -2$, $\lambda_2 = -1$, $\lambda_3 = 3$

\textbf{Step 2:} Classification: Saddle (2-1 type)

\textbf{Step 3:} Manifolds:
\begin{itemize}
    \item $E^s = \text{span}\{e_1, e_2\}$ (xy-plane), $\dim(E^s) = 2$
    \item $E^u = \text{span}\{e_3\}$ (z-axis), $\dim(E^u) = 1$
\end{itemize}

\textbf{Step 4:} Behavior: Trajectories spiral toward xy-plane, then escape along z-axis
\end{example}

\begin{example}[Spiral-Node System]
$$A = \begin{pmatrix} -3 & 0 & 0 \\ 0 & -1 & 4 \\ 0 & -4 & -1 \end{pmatrix}$$

Eigenvalues: $\lambda_1 = -3$, $\lambda_{2,3} = -1 \pm 4i$

Classification: Stable spiral-node
- Exponential decay along x-axis (rate = 3)
- Spiral decay in yz-plane (rate = 1, frequency = 4)
\end{example}

\section{Higher Dimensions (n > 3)}

\begin{keypoint}
\textbf{Classification in n-Dimensions:}
For $\dot{\mathbf{x}} = A\mathbf{x}$ with $A \in \mathbb{R}^{n \times n}$:
\begin{itemize}
    \item Count eigenvalues with $\text{Re}(\lambda) < 0$: $n_s$ (stable directions)
    \item Count eigenvalues with $\text{Re}(\lambda) > 0$: $n_u$ (unstable directions)
    \item Count eigenvalues with $\text{Re}(\lambda) = 0$: $n_c$ (center directions)
    \item Check: $n_s + n_u + n_c = n$
\end{itemize}
\end{keypoint}

\begin{classification}[Stability in Higher Dimensions]
\begin{itemize}
    \item \textbf{Asymptotically Stable}: All $\text{Re}(\lambda_i) < 0$
    \item \textbf{Unstable}: At least one $\text{Re}(\lambda_i) > 0$
    \item \textbf{Marginally Stable}: All $\text{Re}(\lambda_i) \leq 0$, some $= 0$
\end{itemize}
\end{classification}

\section{Numerical Visualization Tools}

\begin{visualization}
\textbf{Essential Plotting Techniques:}
\begin{enumerate}
    \item \textbf{3D Trajectory Plots}: Direct visualization in 3D
    \item \textbf{Multiple 2D Projections}: Show different viewpoints
    \item \textbf{Animation}: Time evolution along trajectories
    \item \textbf{Isosurfaces}: Level sets of conserved quantities
    \item \textbf{Vector Field Slices}: Direction fields on 2D slices
\end{enumerate}
\end{visualization}

\section{Special Phenomena in 3D}

\begin{definition}[Limit Cycle]
A \textbf{limit cycle} is an isolated closed orbit. In 3D, nearby trajectories can spiral toward it (stable) or away (unstable).
\end{definition}

\begin{definition}[Torus Attractor]
Quasi-periodic motion on a 2D torus surface in 3D phase space. Occurs with two incommensurate frequencies.
\end{definition}

\begin{definition}[Strange Attractor]
A fractal set in phase space exhibiting sensitive dependence on initial conditions (chaos). Example: Lorenz attractor.
\end{definition}

\section{The Lorenz System (Preview)}

\begin{example}[Lorenz Equations]
$$\begin{aligned}
\dot{x} &= \sigma(y - x) \\
\dot{y} &= rx - y - xz \\
\dot{z} &= xy - bz
\end{aligned}$$

For $\sigma = 10$, $b = 8/3$, $r = 28$: Chaotic attractor!

Equilibria:
\begin{itemize}
    \item Origin: Always exists
    \item $C_\pm = (\pm\sqrt{b(r-1)}, \pm\sqrt{b(r-1)}, r-1)$ for $r > 1$
\end{itemize}
\end{example}

\section{Exam Strategy for 3D Problems}

\begin{examtip}
\textbf{Prof. Ditkowski's 3D Problem Approach:}
\begin{enumerate}
    \item State system dimension explicitly
    \item Find ALL eigenvalues (check: product = det, sum = trace)
    \item Classify equilibrium type precisely
    \item State manifold dimensions: "2D stable, 1D unstable"
    \item Describe behavior in words
    \item Optional: Sketch ONE key projection
    \item Never attempt full 3D drawing
\end{enumerate}
\end{examtip}

\begin{warning}
\textbf{Common 3D Errors:}
\begin{itemize}
    \item Forgetting complex eigenvalues come in pairs
    \item Wrong manifold dimension count
    \item Trying to visualize 4D+ systems
    \item Missing the third eigenvalue
    \item Not checking $\sum \lambda_i = \text{tr}(A)$
\end{itemize}
\end{warning}

\end{document}
```

## **Part 3: LaTeX Practice Problems**

```latex
\documentclass[12pt]{article}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{geometry, enumitem, mdframed}
\geometry{margin=1in}

\newmdenv[linecolor=blue,linewidth=1pt]{hint}
\newmdenv[linecolor=green,linewidth=1pt]{threedtip}

\title{Practice Problems - Lesson 39: 3D Systems and Higher Dimensions}
\author{ODE 1 Course}
\date{}

\begin{document}
\maketitle

\section*{Part A: 3D Classification (Problems 1-6)}

\begin{enumerate}
\item Classify the 3D equilibrium at the origin for:
\begin{enumerate}[label=(\alph*)]
    \item $A = \begin{pmatrix} -1 & 0 & 0 \\ 0 & -2 & 0 \\ 0 & 0 & -3 \end{pmatrix}$
    \item $A = \begin{pmatrix} 2 & 0 & 0 \\ 0 & -1 & 3 \\ 0 & -3 & -1 \end{pmatrix}$
    \item $A = \begin{pmatrix} 1 & 1 & 0 \\ 0 & 1 & 1 \\ 0 & 0 & 1 \end{pmatrix}$
    \item $A = \begin{pmatrix} 0 & 1 & 0 \\ -4 & 0 & 0 \\ 0 & 0 & -2 \end{pmatrix}$
\end{enumerate}

\item For each set of eigenvalues, classify the 3D equilibrium:
\begin{enumerate}[label=(\alph*)]
    \item $\lambda = -1, -2, -3$
    \item $\lambda = 2, -1 \pm 3i$
    \item $\lambda = 0, \pm 2i$
    \item $\lambda = 1, 1, 1$ (repeated)
\end{enumerate}

\item Find the dimensions of stable and unstable manifolds for:
\begin{enumerate}[label=(\alph*)]
    \item $\lambda = -2, 1, 3$
    \item $\lambda = -1, -2 \pm i$
    \item $\lambda = 0, -1, 2$
    \item $\lambda = \pm 2i, 3$
\end{enumerate}

\item For the system with $A = \begin{pmatrix} -1 & 2 & 0 \\ 0 & -1 & 0 \\ 0 & 0 & 3 \end{pmatrix}$:
\begin{enumerate}[label=(\alph*)]
    \item Find all eigenvalues and eigenvectors
    \item Classify the equilibrium
    \item Identify stable and unstable manifolds
    \item Describe the behavior near origin
\end{enumerate}

\item Given a 3D system has one eigenvalue $\lambda_1 = -2$ and a complex pair with $\text{Re}(\lambda_{2,3}) = 1$:
\begin{enumerate}[label=(\alph*)]
    \item What type of equilibrium is this?
    \item What are the manifold dimensions?
    \item Is the origin stable?
    \item Describe trajectory behavior
\end{enumerate}

\item For the block diagonal system:
$$A = \begin{pmatrix} -3 & 0 & 0 \\ 0 & 1 & -2 \\ 0 & 2 & 1 \end{pmatrix}$$
\begin{enumerate}[label=(\alph*)]
    \item Find eigenvalues without full calculation
    \item Classify the equilibrium
    \item Which coordinate decouples?
    \item Describe motion in each subspace
\end{enumerate}
\end{enumerate}

\section*{Part B: Manifold Analysis (Problems 7-11)}

\begin{enumerate}[resume]
\item For $A = \begin{pmatrix} 2 & 1 & 0 \\ 0 & -1 & 1 \\ 0 & 0 & -2 \end{pmatrix}$:
\begin{enumerate}[label=(\alph*)]
    \item Find all eigenvalues
    \item Find eigenvectors
    \item Determine $E^s$ and $E^u$ explicitly
    \item Write parametric equations for each manifold
\end{enumerate}

\item Given eigenvalues $\lambda_1 = -3$, $\lambda_2 = 2$, $\lambda_3 = 1$ with eigenvectors:
$$v_1 = \begin{pmatrix} 1 \\ 0 \\ 0 \end{pmatrix}, \quad v_2 = \begin{pmatrix} 0 \\ 1 \\ 1 \end{pmatrix}, \quad v_3 = \begin{pmatrix} 0 \\ 1 \\ -1 \end{pmatrix}$$
\begin{enumerate}[label=(\alph*)]
    \item Find the stable manifold equation
    \item Find the unstable manifold equation
    \item Describe trajectories starting in $E^u$
\end{enumerate}

\item For a system with 2D stable manifold in the xy-plane:
\begin{enumerate}[label=(\alph*)]
    \item What can you say about eigenvalues?
    \item What happens to trajectories starting at $(0,0,1)$?
    \item Sketch behavior in xz-projection
\end{enumerate}

\item Consider the saddle with $\lambda = -2, -1, 3$:
\begin{enumerate}[label=(\alph*)]
    \item What type of saddle is this?
    \item If $v_3 = (1,1,1)^T$, describe escape direction
    \item How fast do trajectories approach $E^s$?
\end{enumerate}

\item For a spiral-saddle system:
\begin{enumerate}[label=(\alph*)]
    \item What are possible eigenvalue configurations?
    \item Describe motion in the spiral plane
    \item What determines overall stability?
\end{enumerate}
\end{enumerate}

\section*{Part C: Projections (Problems 12-16)}

\begin{enumerate}[resume]
\item For the system $\dot{x} = -x$, $\dot{y} = -2y + z$, $\dot{z} = -y - 2z$:
\begin{enumerate}[label=(\alph*)]
    \item Find eigenvalues
    \item Sketch xy-projection
    \item Sketch xz-projection
    \item Sketch yz-projection
    \item Which projection best shows the spiral?
\end{enumerate}

\item Given a 3D center-line with eigenvalues $0, \pm 3i$:
\begin{enumerate}[label=(\alph*)]
    \item Which variable corresponds to the zero eigenvalue?
    \item What do trajectories look like?
    \item Draw the three projections
\end{enumerate}

\item For a stable spiral-node with spiral in xy-plane:
\begin{enumerate}[label=(\alph*)]
    \item What does xz-projection show?
    \item What does yz-projection show?
    \item Which projection shows spiral clearly?
\end{enumerate}

\item Project the trajectory of:
$$\dot{x} = -x, \quad \dot{y} = y, \quad \dot{z} = -2z$$
starting at $(1,1,1)$ onto all three coordinate planes.

\item For the system with solution:
$$\mathbf{x}(t) = e^{-t}\begin{pmatrix} \cos(2t) \\ \sin(2t) \\ 1 \end{pmatrix}$$
\begin{enumerate}[label=(\alph*)]
    \item Find the system matrix $A$
    \item Draw xy-projection
    \item Draw xz-projection
    \item What type of equilibrium?
\end{enumerate}
\end{enumerate}

\section*{Part D: Poincaré Sections (Problems 17-20)}

\begin{enumerate}[resume]
\item For periodic motion in 3D with period $T = 2\pi$:
\begin{enumerate}[label=(\alph*)]
    \item What does Poincaré section show?
    \item How many points for one trajectory?
    \item What if period doubles?
\end{enumerate}

\item Consider the plane $z = 0$ as Poincaré section for:
$$\dot{x} = y, \quad \dot{y} = -x, \quad \dot{z} = -z + x^2$$
\begin{enumerate}[label=(\alph*)]
    \item When do trajectories cross $z = 0$?
    \item What pattern emerges?
    \item Is motion periodic?
\end{enumerate}

\item For quasi-periodic motion on a torus:
\begin{enumerate}[label=(\alph*)]
    \item What does Poincaré section look like?
    \item How to distinguish from periodic?
    \item What if frequencies are rational?
\end{enumerate}

\item Design a Poincaré section to best reveal:
\begin{enumerate}[label=(\alph*)]
    \item Periodic orbits
    \item Chaotic trajectories
    \item Quasi-periodic motion
\end{enumerate}
\end{enumerate}

\section*{Part E: Higher Dimensions (Problems 21-24)}

\begin{enumerate}[resume]
\item For a 4D system with eigenvalues $-1, -2, 3, 4$:
\begin{enumerate}[label=(\alph*)]
    \item Find dimensions of invariant manifolds
    \item Is the origin stable?
    \item What's the dominant behavior?
\end{enumerate}

\item In 5D with eigenvalues $-1 \pm i, -2, 3 \pm 2i$:
\begin{enumerate}[label=(\alph*)]
    \item Classify stability
    \item Find $\dim(E^s)$ and $\dim(E^u)$
    \item How many rotation planes?
\end{enumerate}

\item For an n-dimensional system:
\begin{enumerate}[label=(\alph*)]
    \item Maximum number of complex eigenvalues?
    \item When is origin globally stable?
    \item When do all trajectories escape?
\end{enumerate}

\item Given a 10D system with 8 negative and 2 positive eigenvalues:
\begin{enumerate}[label=(\alph*)]
    \item What are manifold dimensions?
    \item Describe long-term behavior
    \item What's the "most likely" outcome?
\end{enumerate}
\end{enumerate}

\section*{Part F: Special 3D Phenomena (Problems 25-27)}

\begin{enumerate}[resume]
\item For the Rössler system:
$$\dot{x} = -y - z, \quad \dot{y} = x + ay, \quad \dot{z} = b + z(x - c)$$
\begin{enumerate}[label=(\alph*)]
    \item Find equilibria when $a = b = 0.2$, $c = 5.7$
    \item Linearize at equilibria
    \item What type of attractor exists?
\end{enumerate}

\item Consider a 3D system with a stable limit cycle:
\begin{enumerate}[label=(\alph*)]
    \item Can this happen in a linear system?
    \item What do nearby trajectories do?
    \item How would you detect this numerically?
\end{enumerate}

\item For motion on a 2-torus in 3D:
\begin{enumerate}[label=(\alph*)]
    \item What are the two frequencies?
    \item When is motion periodic?
    \item When is trajectory dense on torus?
\end{enumerate}
\end{enumerate}

\section*{Part G: Exam-Style Problems (Problems 28-30)}

\begin{enumerate}[resume]
\item \textbf{[Prof. Ditkowski Style - 3D Complete Analysis]}
For the system:
$$A = \begin{pmatrix} -1 & 0 & 1 \\ 2 & -2 & 0 \\ 0 & 0 & -3 \end{pmatrix}$$
\begin{enumerate}[label=(\alph*)]
    \item Find all eigenvalues (show characteristic polynomial)
    \item Verify using trace and determinant
    \item Classify the equilibrium type
    \item Find eigenvectors for all eigenvalues
    \item Identify and state dimensions of $E^s$ and $E^u$
    \item Describe behavior in each invariant subspace
    \item Sketch the xy-projection
    \item Sketch the xz-projection
    \item Which trajectories approach origin fastest?
    \item Write the general solution
\end{enumerate}

\item \textbf{[Higher-D Application]}
A 6D linear system models coupled oscillators with eigenvalues:
$$\lambda_{1,2} = -0.1 \pm 2i, \quad \lambda_{3,4} = -0.2 \pm 3i, \quad \lambda_{5,6} = 0.1 \pm i$$
\begin{enumerate}[label=(\alph*)]
    \item Is the system stable? Why?
    \item How many oscillation frequencies?
    \item Find dimensions of stable/unstable manifolds
    \item Which oscillator damps fastest?
    \item What happens as $t \to \infty$?
    \item Describe the attractor type
\end{enumerate}

\item \textbf{[Conceptual Understanding]}
\begin{enumerate}[label=(\alph*)]
    \item Prove: A 3D linear system cannot have all complex eigenvalues
    \item Show: If two eigenvalues are complex conjugates, the third must be real
    \item Explain: Why can 4D systems have two pairs of complex eigenvalues?
    \item True/False: A 3D saddle is always unstable
    \item Can a 3D linear system have a limit cycle?
    \item What's the minimum dimension for quasi-periodic motion?
    \item In 3D, if $\det(A) < 0$, what can you conclude?
    \item How many types of 3D saddles exist?
\end{enumerate}
\end{enumerate}

\begin{threedtip}
\textbf{3D Visualization Strategy:}
\begin{itemize}
    \item Don't try to draw full 3D portraits
    \item Use projections to show key features
    \item Describe behavior verbally
    \item State manifold dimensions explicitly
    \item Use computer tools when possible
    \item Focus on eigenvalue analysis
\end{itemize}
\end{threedtip}

\end{document}
```

## **Part 4: NotebookLM Instructions**

### **How to Use These Materials with NotebookLM**

**Step 1: Document Setup**
- Save audio script as text file
- Compile theory and practice documents to PDF
- Create notebook: "ODE Lesson 39 - 3D Systems"
- Upload all materials
- Add any 3D visualization examples you have

**Step 2: Audio Strategy**
- Generate conversational audio from script
- Use moderate pace for complex concepts
- Consider breaking into two parts: 3D basics and higher-D
- Listen while reviewing 3D visualizations online

**Step 3: Progressive Learning Path**

**Hour 1: 3D Fundamentals**
- Audio lesson (30 min)
- Theory Sections 1-3 (30 min)
- Understand eigenvalue combinations
- Problems 1-3

**Hour 2: Manifold Mastery**
- Theory Section 3 (detailed read)
- Problems 7-11
- Create manifold dimension table
- Practice identifying $E^s$, $E^u$, $E^c$

**Hour 3: Visualization Techniques**
- Theory Sections 4-5
- Problems 12-16 (projections)
- Problems 17-20 (Poincaré)
- Sketch multiple projections

**Hour 4: Higher Dimensions**
- Theory Section 6
- Problems 21-24
- Focus on stability criteria
- Understand dimension limits

**Hour 5: Applications and Integration**
- Problems 25-27 (special phenomena)
- Review Lorenz system
- Connect to real applications

**Hour 6: Exam Preparation**
- Problems 28-30 under timed conditions
- Focus on systematic analysis
- Practice verbal descriptions

**Step 4: Computational Tools**

```python
import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from scipy.integrate import odeint

def analyze_3d_system(A):
    """Complete 3D system analysis"""
    eigenvalues, eigenvectors = np.linalg.eig(A)

    print("3D System Analysis")
    print("="*40)
    print(f"Eigenvalues: {eigenvalues}")

    # Count stable/unstable
    stable = sum(1 for λ in eigenvalues if λ.real < 0)
    unstable = sum(1 for λ in eigenvalues if λ.real > 0)
    center = sum(1 for λ in eigenvalues if λ.real == 0)

    print(f"Stable manifold dimension: {stable}")
    print(f"Unstable manifold dimension: {unstable}")
    print(f"Center manifold dimension: {center}")

    # Classification
    if all(λ.real < 0 for λ in eigenvalues):
        print("Classification: Stable Node/Focus")
    elif all(λ.real > 0 for λ in eigenvalues):
        print("Classification: Unstable Node/Focus")
    elif unstable > 0 and stable > 0:
        print(f"Classification: Saddle ({stable}-{unstable} type)")
    else:
        print("Classification: Center or degenerate")

    return eigenvalues, eigenvectors

def plot_3d_trajectories(A, initial_conditions, T=10):
    """Plot 3D phase portrait"""

    def system(state, t):
        return A @ state

    fig = plt.figure(figsize=(15, 5))

    # 3D plot
    ax1 = fig.add_subplot(131, projection='3d')

    for ic in initial_conditions:
        t = np.linspace(0, T, 1000)
        trajectory = odeint(system, ic, t)
        ax1.plot(trajectory[:, 0], trajectory[:, 1], trajectory[:, 2])

    ax1.set_xlabel('X')
    ax1.set_ylabel('Y')
    ax1.set_zlabel('Z')
    ax1.set_title('3D Phase Portrait')

    # Projections
    ax2 = fig.add_subplot(132)
    ax3 = fig.add_subplot(133)

    for ic in initial_conditions:
        t = np.linspace(0, T, 1000)
        trajectory = odeint(system, ic, t)
        ax2.plot(trajectory[:, 0], trajectory[:, 1], alpha=0.7)
        ax3.plot(trajectory[:, 0], trajectory[:, 2], alpha=0.7)

    ax2.set_xlabel('X')
    ax2.set_ylabel('Y')
    ax2.set_title('XY Projection')
    ax2.grid(True)

    ax3.set_xlabel('X')
    ax3.set_ylabel('Z')
    ax3.set_title('XZ Projection')
    ax3.grid(True)

    plt.tight_layout()
    return fig

# Example: Spiral-saddle
A = np.array([[-1, 2, 0],
              [-2, -1, 0],
              [0, 0, 1.5]])

eigenvals, eigenvecs = analyze_3d_system(A)

# Generate initial conditions
initial_conditions = []
for r in [0.1, 0.2]:
    for theta in np.linspace(0, 2*np.pi, 6):
        initial_conditions.append([r*np.cos(theta), r*np.sin(theta), 0.01])

fig = plot_3d_trajectories(A, initial_conditions)
plt.show()
```

**Step 5: Visualization Resources**

**Online Tools:**
- Wolfram Alpha: "phase portrait of {matrix}"
- GeoGebra 3D Calculator
- MATLAB's `quiver3` and `streamline`
- Python's matplotlib 3D plotting

**Key Visualizations to Create:**
1. All 3D saddle types (1-2 and 2-1)
2. Spiral-node (stable and unstable)
3. Projections of each type
4. Poincaré section examples

**Step 6: Learning Activities**

**Activity 1: Eigenvalue Bingo**
Create cards with different eigenvalue combinations. Match to equilibrium types.

**Activity 2: Projection Practice**
Given a 3D trajectory, sketch its three projections without computation.

**Activity 3: Manifold Dimensions**
Flash cards: eigenvalues → manifold dimensions

**Activity 4: Higher-D Challenge**
Generate random 5D eigenvalues, classify stability instantly.

**Step 7: Common Conceptual Hurdles**

**Issue: Can't visualize 3D spirals**
- Solution: Think of spiral staircase
- Use hand motions to show rotation + translation

**Issue: Confused about manifold dimensions**
- Solution: Count eigenvalues by sign
- Negative → stable, Positive → unstable

**Issue: Projections look wrong**
- Solution: Remember each projection loses information
- A 3D spiral might look like 2D node in some projections

**Issue: Higher dimensions seem abstract**
- Solution: Focus on eigenvalue counting
- Don't try to visualize, use algebra

**Step 8: Quick Reference Cards**

**Card 1: 3D Classification**
```
3D EQUILIBRIUM TYPES:
All λ < 0 → Stable node/focus
All λ > 0 → Unstable node/focus
Mixed signs → Saddle
  - 1 pos, 2 neg → Saddle (1-2)
  - 2 pos, 1 neg → Saddle (2-1)
Complex pair + real → Spiral-node/saddle
```

**Card 2: Manifold Dimensions**
```
dim(E^s) = # of eigenvalues with Re(λ) < 0
dim(E^u) = # of eigenvalues with Re(λ) > 0
dim(E^c) = # of eigenvalues with Re(λ) = 0

Check: dim(E^s) + dim(E^u) + dim(E^c) = n
```

**Card 3: Projection Insights**
```
XY-projection: Shows z = 0 behavior
XZ-projection: Shows y = 0 behavior
YZ-projection: Shows x = 0 behavior

Spiral in one projection → Complex eigenvalues
Node in all projections → All real eigenvalues
```

**Step 9: Integration with Course**

**Connections:**
- Extends 2D classification (Lesson 37)
- Uses 2D drawing skills (Lesson 38)
- Foundation for nonlinear 3D systems
- Critical for applications (engineering, biology)

**Exam Weight:**
- Usually 1 problem on 3D systems (10-15 points)
- Focus on eigenvalue analysis and classification
- Manifold dimensions always tested
- No complex 3D drawings required

**Step 10: Self-Assessment Checklist**

After this lesson, you should be able to:
- [ ] Classify any 3D equilibrium from eigenvalues
- [ ] Find manifold dimensions instantly
- [ ] Describe 3D behavior verbally
- [ ] Draw meaningful projections
- [ ] Understand Poincaré sections conceptually
- [ ] Extend to n-dimensions algebraically
- [ ] Recognize special 3D phenomena
- [ ] Solve exam problems systematically

**Time Management:**
- Theory understanding: 1.5 hours
- 3D practice: 2 hours
- Projections: 1 hour
- Higher-D concepts: 1 hour
- Applications: 0.5 hours
- **Total: 6 hours**

**Final Tips:**
1. Don't over-visualize - use algebra
2. Always state manifold dimensions
3. Describe behavior in words on exams
4. Use computer tools to verify understanding
5. Focus on systematic analysis over artistic drawing

---

**Lesson 39 complete. This concludes Block 10: Phase Portraits!**

**Block 10 Summary:**
- Lesson 36: Phase space concepts and foundations
- Lesson 37: Complete 2D classification
- Lesson 38: Drawing techniques and practice
- Lesson 39: Extension to 3D and higher dimensions

You now have the complete geometric understanding of ODEs! These four lessons provide the visual intuition that makes all other ODE topics clearer. Master these phase portrait techniques, and you'll excel in Prof. Ditkowski's exam!
