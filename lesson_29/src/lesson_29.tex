\documentclass[12pt]{article}
\usepackage{amsmath, amssymb, amsthm, tikz, pgfplots}
\usepackage{geometry, enumitem, mdframed, array, xcolor}
\geometry{margin=1in}

\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{proposition}{Proposition}
\newtheorem{example}{Example}
\newmdenv[linecolor=blue,linewidth=2pt]{keypoint}
\newmdenv[linecolor=red,linewidth=2pt]{warning}
\newmdenv[linecolor=green,linewidth=2pt]{insight}
\newmdenv[linecolor=purple,linewidth=2pt]{examtip}
\newmdenv[linecolor=brown,linewidth=2pt]{computation}

\title{ODE Lesson 29: Liouville's Formula and Applications}
\author{ODE 1 - Prof. Adi Ditkowski}
\date{}

\begin{document}
\maketitle

\section{Liouville's Formula}

\begin{theorem}[Liouville's Formula]
For the system $\mathbf{x}' = A(t)\mathbf{x}$ with continuous $A(t)$, the Wronskian of any $n$ solutions satisfies:
$$W(t) = W(t_{0}) \exp\left(\int_{t_{0}}^{t} \text{tr}(A(s))\,ds\right)$$
where $\text{tr}(A)$ denotes the trace (sum of diagonal elements).
\end{theorem}

\begin{keypoint}
Liouville's Formula reveals that:
\begin{itemize}
\item The trace alone determines Wronskian evolution
\item Volume in phase space changes at rate $\text{tr}(A(t))$
\item System stability is linked to the sign of $\text{tr}(A)$
\end{itemize}
\end{keypoint}

\section{Trace Properties and Computation}

\begin{definition}[Matrix Trace]
For an $n \times n$ matrix $A = [a_{ij}]$:
$$\text{tr}(A) = \sum_{i=1}^{n} a_{ii} = a_{11} + a_{22} + \cdots + a_{nn}$$
\end{definition}

\begin{proposition}[Trace Properties]
\begin{enumerate}
\item $\text{tr}(A + B) = \text{tr}(A) + \text{tr}(B)$ (linearity)
\item $\text{tr}(cA) = c \cdot \text{tr}(A)$
\item $\text{tr}(AB) = \text{tr}(BA)$ (cyclic property)
\item $\text{tr}(A) = \sum_{i=1}^{n} \lambda_{i}$ (sum of eigenvalues)
\item $\text{tr}(A^{T}) = \text{tr}(A)$
\end{enumerate}
\end{proposition}

\section{Special Cases}

\begin{corollary}[Constant Coefficient Systems]
For $\mathbf{x}' = A\mathbf{x}$ with constant $A$:
$W(t) = W(0) \cdot $e^{\text{tr}$(A) \cdot t}$
\end{corollary}

\begin{example}[Volume-Preserving Systems]
If $\text{tr}(A(t)) = 0$ for all $t$, then:
$$W(t) = W(t_{0}) = \text{constant}$$
Such systems preserve phase space volume (incompressible flow).
\end{example}

\begin{insight}
Classification by trace:
\begin{itemize}
\item $\text{tr}(A) > 0$: Expanding system (unstable)
\item $\text{tr}(A) < 0$: Contracting system (stable)
\item $\text{tr}(A) = 0$: Volume-preserving (neutral)
\end{itemize}
\end{insight}

\section{Applications to Stability}

\begin{theorem}[Stability via Trace]
For the system $\mathbf{x}' = A\mathbf{x}$ with constant $A$:
\begin{enumerate}
\item If $\text{tr}(A) < 0$ and $\det(A) > 0$, the origin is asymptotically stable
\item If $\text{tr}(A) > 0$, the origin is unstable
\item If $\text{tr}(A) = 0$, further analysis is needed
\end{enumerate}
\end{theorem}

\begin{example}[Second-Order Scalar Equation]
For $y'' + py' + qy = 0$, the companion matrix has trace $-p.
Thus: W(t) = W(0) \cdot $e^{-pt}$

Stability criterion: p > 0 implies Wronskian decay.
\end{example}

\section{Geometric Interpretation}

\begin{proposition}[Phase Space Volume]
The Wronskian $W(t)$ represents the volume of the parallelepiped formed by solution vectors in phase space. Liouville's formula describes how this volume evolves.
\end{proposition}

\begin{computation}
For a 2D system:
\begin{itemize}
\item Solutions $\mathbf{x}_{1}(t), \mathbf{x}_{2}(t)$ form a parallelogram
\item Area = $|W(t)|$
\item Rate of area change = $\text{tr}(A(t)) \cdot |W(t)|$
\end{itemize}
\end{computation}

\section{Connection to Divergence}

\begin{theorem}[Divergence Theorem Connection]
For the vector field $\mathbf{F}(\mathbf{x}) = A\mathbf{x}$:
$$\text{div}(\mathbf{F}) = \text{tr}(A)$$
This links Liouville's formula to the divergence theorem in vector calculus.
\end{theorem}

\section{Examples and Applications}

\begin{example}[Hamiltonian System]
For a Hamiltonian system:
$$\begin{cases}
\dot{q} = \frac{\partial H}{\partial p} \\
\dot{p} = -\frac{\partial H}{\partial q}
\end{cases}$$
The system matrix has trace zero, so phase space volume is preserved (Liouville's theorem in mechanics).
\end{example}

\begin{example}[Damped Oscillator]
For $\ddot{x} + 2\zeta\omega\dot{x} + \omega^{2x} = 0$:
\begin{itemize}
\item Companion matrix trace = $-2\zeta\omega$
\item W(t) = W(0) \cdot $e^{-2\zeta\omega t}$
\item Damping $(\zeta > 0)$ causes Wronskian decay
\end{itemize}
\end{example}

\begin{warning}
Common errors:
\begin{itemize}
\item Confusing trace with determinant
\item Forgetting the integral for time-dependent $A(t)$
\item Missing that $\text{tr}(A) = \sum\lambda_{i}$
\item Not recognizing volume-preserving systems
\end{itemize}
\end{warning}

\section{Advanced Applications}

\begin{proposition}[Periodic Systems]
For $T$-periodic $A(t)$, stability depends on:
$$\mu = \frac{1}{T}\int_{0}^T \text{tr}(A(s))\,ds$$
\begin{itemize}
\item $\mu < 0$: Stable
\item $\mu > 0$: Unstable
\item $\mu = 0$: Marginally stable
\end{itemize}
\end{proposition}

\begin{examtip}
Prof. Ditkowski's favorite Liouville problems:
\begin{itemize}
\item Computing $W(t)$ using trace
\item Identifying volume-preserving systems
\item Stability analysis via trace
\item Connection to eigenvalue sum
\item Time-dependent trace integrals
\end{itemize}
\end{examtip}

\section{Quick Reference}

\begin{keypoint}
Essential formulas:
\begin{itemize}
\item General: W(t) = W(t_{0})$e^{\int_{t_{0}$}^{t} \text{tr}(A(s))ds}
\item Constant: W(t) = W(0)$e^{\text{tr}$(A) \cdot t}
\item Scalar $n$th order: W(t) = W(0)$e^{-\int a_{n-1}$(s)ds}
\item Trace-eigenvalue: $\text{tr}(A) = \lambda_{1} + \cdots + \lambda_{n}$
\end{itemize}
\end{keypoint}

\end{document}